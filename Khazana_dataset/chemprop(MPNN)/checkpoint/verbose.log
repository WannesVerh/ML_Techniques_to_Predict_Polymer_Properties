Command line
python C:\Users\wanne\AppData\Local\Programs\Python\Python310\Scripts\chemprop_train --data_path ./csv_files/Polymers_Eat.csv --dataset_type regression --save_dir checkpoint
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/Polymers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.269621
Epoch 1
Loss = 4.9524e-01, PNorm = 34.0367, GNorm = 5.8949, lr_0 = 1.0000e-03
Validation rmse = 0.180477
Epoch 2
Validation rmse = 0.175057
Epoch 3
Loss = 1.9783e-01, PNorm = 34.0841, GNorm = 0.5301, lr_0 = 8.4834e-04
Validation rmse = 0.155382
Epoch 4
Loss = 1.5894e-01, PNorm = 34.1166, GNorm = 0.6723, lr_0 = 7.2962e-04
Validation rmse = 0.152049
Epoch 5
Validation rmse = 0.127462
Epoch 6
Loss = 9.1617e-02, PNorm = 34.1410, GNorm = 0.6622, lr_0 = 6.2751e-04
Validation rmse = 0.124463
Epoch 7
Validation rmse = 0.109621
Epoch 8
Loss = 2.7033e-02, PNorm = 34.1663, GNorm = 1.5388, lr_0 = 5.3234e-04
Validation rmse = 0.100677
Epoch 9
Loss = 6.0310e-02, PNorm = 34.1833, GNorm = 1.1763, lr_0 = 4.6416e-04
Validation rmse = 0.096233
Epoch 10
Validation rmse = 0.088408
Epoch 11
Loss = 4.8576e-02, PNorm = 34.1980, GNorm = 3.0190, lr_0 = 3.9377e-04
Validation rmse = 0.088261
Epoch 12
Loss = 4.0376e-02, PNorm = 34.2081, GNorm = 2.1901, lr_0 = 3.3866e-04
Validation rmse = 0.072880
Epoch 13
Validation rmse = 0.074117
Epoch 14
Loss = 2.9638e-02, PNorm = 34.2176, GNorm = 1.5122, lr_0 = 2.9126e-04
Validation rmse = 0.075204
Epoch 15
Validation rmse = 0.067249
Epoch 16
Loss = 2.7263e-02, PNorm = 34.2254, GNorm = 0.4222, lr_0 = 2.4709e-04
Validation rmse = 0.064966
Epoch 17
Loss = 1.3779e-02, PNorm = 34.2301, GNorm = 0.8317, lr_0 = 2.1544e-04
Validation rmse = 0.063238
Epoch 18
Validation rmse = 0.062209
Epoch 19
Loss = 2.2177e-02, PNorm = 34.2347, GNorm = 1.1778, lr_0 = 1.8277e-04
Validation rmse = 0.061001
Epoch 20
Loss = 2.1519e-02, PNorm = 34.2381, GNorm = 1.5615, lr_0 = 1.5719e-04
Validation rmse = 0.060365
Epoch 21
Validation rmse = 0.063118
Epoch 22
Loss = 1.7815e-02, PNorm = 34.2411, GNorm = 0.7914, lr_0 = 1.3519e-04
Validation rmse = 0.058431
Epoch 23
Validation rmse = 0.059245
Epoch 24
Loss = 1.4564e-02, PNorm = 34.2439, GNorm = 0.4033, lr_0 = 1.1469e-04
Validation rmse = 0.057316
Epoch 25
Loss = 1.8541e-02, PNorm = 34.2460, GNorm = 1.4425, lr_0 = 1.0000e-04
Validation rmse = 0.057688
Epoch 26
Validation rmse = 0.059294
Epoch 27
Loss = 1.4505e-02, PNorm = 34.2485, GNorm = 0.2266, lr_0 = 1.0000e-04
Validation rmse = 0.057366
Epoch 28
Loss = 1.6110e-02, PNorm = 34.2508, GNorm = 0.6797, lr_0 = 1.0000e-04
Loss = 1.1988e-02, PNorm = 34.2509, GNorm = 0.6031, lr_0 = 1.0000e-04
Validation rmse = 0.055100
Epoch 29
Validation rmse = 0.056154
Model 0 best validation rmse = 0.055100 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.100295
Ensemble test rmse = 0.100295
1-fold cross validation
	Seed 0 ==> test rmse = 0.100295
Overall test rmse = 0.100295 +/- 0.000000
Elapsed time = 0:00:22
Command line
python C:\Users\wanne\AppData\Local\Programs\Python\Python310\Scripts\chemprop_train --data_path ./csv_files/Polymers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/Polymers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.269621
Epoch 1
Loss = 4.9524e-01, PNorm = 34.0367, GNorm = 5.8949, lr_0 = 1.0000e-03
Validation rmse = 0.180477
Epoch 2
Validation rmse = 0.175057
Epoch 3
Loss = 1.9783e-01, PNorm = 34.0841, GNorm = 0.5301, lr_0 = 8.4834e-04
Validation rmse = 0.155382
Epoch 4
Loss = 1.5894e-01, PNorm = 34.1166, GNorm = 0.6723, lr_0 = 7.2962e-04
Validation rmse = 0.152049
Epoch 5
Validation rmse = 0.127462
Epoch 6
Loss = 9.1617e-02, PNorm = 34.1410, GNorm = 0.6622, lr_0 = 6.2751e-04
Validation rmse = 0.124463
Epoch 7
Validation rmse = 0.109621
Epoch 8
Loss = 2.7033e-02, PNorm = 34.1663, GNorm = 1.5388, lr_0 = 5.3234e-04
Validation rmse = 0.100677
Epoch 9
Loss = 6.0310e-02, PNorm = 34.1833, GNorm = 1.1763, lr_0 = 4.6416e-04
Validation rmse = 0.096233
Epoch 10
Validation rmse = 0.088408
Epoch 11
Loss = 4.8576e-02, PNorm = 34.1980, GNorm = 3.0190, lr_0 = 3.9377e-04
Validation rmse = 0.088261
Epoch 12
Loss = 4.0376e-02, PNorm = 34.2081, GNorm = 2.1901, lr_0 = 3.3866e-04
Validation rmse = 0.072880
Epoch 13
Validation rmse = 0.074117
Epoch 14
Loss = 2.9638e-02, PNorm = 34.2176, GNorm = 1.5122, lr_0 = 2.9126e-04
Validation rmse = 0.075204
Epoch 15
Validation rmse = 0.067249
Epoch 16
Loss = 2.7263e-02, PNorm = 34.2254, GNorm = 0.4222, lr_0 = 2.4709e-04
Validation rmse = 0.064966
Epoch 17
Loss = 1.3779e-02, PNorm = 34.2301, GNorm = 0.8317, lr_0 = 2.1544e-04
Validation rmse = 0.063238
Epoch 18
Validation rmse = 0.062209
Epoch 19
Loss = 2.2177e-02, PNorm = 34.2347, GNorm = 1.1778, lr_0 = 1.8277e-04
Validation rmse = 0.061001
Epoch 20
Loss = 2.1519e-02, PNorm = 34.2381, GNorm = 1.5615, lr_0 = 1.5719e-04
Validation rmse = 0.060365
Epoch 21
Validation rmse = 0.063118
Epoch 22
Loss = 1.7815e-02, PNorm = 34.2411, GNorm = 0.7914, lr_0 = 1.3519e-04
Validation rmse = 0.058431
Epoch 23
Validation rmse = 0.059245
Epoch 24
Loss = 1.4564e-02, PNorm = 34.2439, GNorm = 0.4033, lr_0 = 1.1469e-04
Validation rmse = 0.057316
Epoch 25
Loss = 1.8541e-02, PNorm = 34.2460, GNorm = 1.4425, lr_0 = 1.0000e-04
Validation rmse = 0.057688
Epoch 26
Validation rmse = 0.059294
Epoch 27
Loss = 1.4505e-02, PNorm = 34.2485, GNorm = 0.2266, lr_0 = 1.0000e-04
Validation rmse = 0.057366
Epoch 28
Loss = 1.6110e-02, PNorm = 34.2508, GNorm = 0.6797, lr_0 = 1.0000e-04
Loss = 1.1988e-02, PNorm = 34.2509, GNorm = 0.6031, lr_0 = 1.0000e-04
Validation rmse = 0.055100
Epoch 29
Validation rmse = 0.056154
Model 0 best validation rmse = 0.055100 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.100295
Ensemble test rmse = 0.100295
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.165141
Epoch 1
Loss = 4.1795e-01, PNorm = 34.0376, GNorm = 1.5927, lr_0 = 1.0000e-03
Validation rmse = 0.141351
Epoch 2
Validation rmse = 0.129071
Epoch 3
Loss = 1.5872e-01, PNorm = 34.0896, GNorm = 2.2771, lr_0 = 8.4834e-04
Validation rmse = 0.155226
Epoch 4
Loss = 1.4736e-01, PNorm = 34.1228, GNorm = 0.7535, lr_0 = 7.2962e-04
Validation rmse = 0.129522
Epoch 5
Validation rmse = 0.105419
Epoch 6
Loss = 9.2302e-02, PNorm = 34.1491, GNorm = 1.6146, lr_0 = 6.2751e-04
Validation rmse = 0.098700
Epoch 7
Validation rmse = 0.108479
Epoch 8
Loss = 6.9239e-02, PNorm = 34.1743, GNorm = 3.3022, lr_0 = 5.3234e-04
Validation rmse = 0.086171
Epoch 9
Loss = 4.1668e-02, PNorm = 34.1901, GNorm = 0.3463, lr_0 = 4.6416e-04
Validation rmse = 0.084850
Epoch 10
Validation rmse = 0.080244
Epoch 11
Loss = 4.0361e-02, PNorm = 34.2036, GNorm = 1.5672, lr_0 = 3.9377e-04
Validation rmse = 0.075061
Epoch 12
Loss = 3.1749e-02, PNorm = 34.2126, GNorm = 3.1962, lr_0 = 3.3866e-04
Validation rmse = 0.074857
Epoch 13
Validation rmse = 0.072599
Epoch 14
Loss = 2.0363e-02, PNorm = 34.2190, GNorm = 0.2436, lr_0 = 2.9126e-04
Validation rmse = 0.066238
Epoch 15
Validation rmse = 0.063873
Epoch 16
Loss = 2.2169e-02, PNorm = 34.2257, GNorm = 0.7254, lr_0 = 2.4709e-04
Validation rmse = 0.063592
Epoch 17
Loss = 1.8420e-02, PNorm = 34.2305, GNorm = 1.2849, lr_0 = 2.1544e-04
Validation rmse = 0.072412
Epoch 18
Validation rmse = 0.062860
Epoch 19
Loss = 1.5132e-02, PNorm = 34.2339, GNorm = 1.2577, lr_0 = 1.8277e-04
Validation rmse = 0.068704
Epoch 20
Loss = 1.7073e-02, PNorm = 34.2364, GNorm = 0.8561, lr_0 = 1.5719e-04
Validation rmse = 0.062590
Epoch 21
Validation rmse = 0.064174
Epoch 22
Loss = 1.6229e-02, PNorm = 34.2398, GNorm = 1.5302, lr_0 = 1.3519e-04
Validation rmse = 0.058672
Epoch 23
Validation rmse = 0.058450
Epoch 24
Loss = 1.3637e-02, PNorm = 34.2419, GNorm = 0.6766, lr_0 = 1.1469e-04
Validation rmse = 0.058289
Epoch 25
Loss = 1.0752e-02, PNorm = 34.2435, GNorm = 0.6842, lr_0 = 1.0000e-04
Validation rmse = 0.056828
Epoch 26
Validation rmse = 0.056625
Epoch 27
Loss = 1.1614e-02, PNorm = 34.2455, GNorm = 0.7464, lr_0 = 1.0000e-04
Validation rmse = 0.055838
Epoch 28
Loss = 1.3119e-02, PNorm = 34.2474, GNorm = 0.6189, lr_0 = 1.0000e-04
Loss = 9.1975e-03, PNorm = 34.2476, GNorm = 0.7917, lr_0 = 1.0000e-04
Validation rmse = 0.059112
Epoch 29
Validation rmse = 0.056155
Model 0 best validation rmse = 0.055838 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.050819
Ensemble test rmse = 0.050819
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.198698
Epoch 1
Loss = 3.7305e-01, PNorm = 34.0380, GNorm = 4.0471, lr_0 = 1.0000e-03
Validation rmse = 0.165529
Epoch 2
Validation rmse = 0.171133
Epoch 3
Loss = 1.4358e-01, PNorm = 34.0912, GNorm = 1.3859, lr_0 = 8.4834e-04
Validation rmse = 0.131954
Epoch 4
Loss = 1.4428e-01, PNorm = 34.1190, GNorm = 1.3901, lr_0 = 7.2962e-04
Validation rmse = 0.117991
Epoch 5
Validation rmse = 0.102099
Epoch 6
Loss = 8.0058e-02, PNorm = 34.1417, GNorm = 1.5776, lr_0 = 6.2751e-04
Validation rmse = 0.093086
Epoch 7
Validation rmse = 0.090354
Epoch 8
Loss = 6.8895e-02, PNorm = 34.1629, GNorm = 3.0916, lr_0 = 5.3234e-04
Validation rmse = 0.081313
Epoch 9
Loss = 5.4840e-02, PNorm = 34.1760, GNorm = 3.1879, lr_0 = 4.6416e-04
Validation rmse = 0.083599
Epoch 10
Validation rmse = 0.069874
Epoch 11
Loss = 4.5203e-02, PNorm = 34.1893, GNorm = 2.5113, lr_0 = 3.9377e-04
Validation rmse = 0.070037
Epoch 12
Loss = 3.3131e-02, PNorm = 34.1986, GNorm = 1.0398, lr_0 = 3.3866e-04
Validation rmse = 0.065953
Epoch 13
Validation rmse = 0.068254
Epoch 14
Loss = 2.3628e-02, PNorm = 34.2055, GNorm = 0.5169, lr_0 = 2.9126e-04
Validation rmse = 0.062620
Epoch 15
Validation rmse = 0.058199
Epoch 16
Loss = 1.6729e-02, PNorm = 34.2116, GNorm = 1.2696, lr_0 = 2.4709e-04
Validation rmse = 0.057762
Epoch 17
Loss = 2.2852e-02, PNorm = 34.2156, GNorm = 0.3260, lr_0 = 2.1544e-04
Validation rmse = 0.055195
Epoch 18
Validation rmse = 0.054008
Epoch 19
Loss = 2.0986e-02, PNorm = 34.2200, GNorm = 0.6456, lr_0 = 1.8277e-04
Validation rmse = 0.053400
Epoch 20
Loss = 1.9108e-02, PNorm = 34.2232, GNorm = 0.7060, lr_0 = 1.5719e-04
Validation rmse = 0.052595
Epoch 21
Validation rmse = 0.055991
Epoch 22
Loss = 2.0893e-02, PNorm = 34.2259, GNorm = 1.1869, lr_0 = 1.3519e-04
Validation rmse = 0.052067
Epoch 23
Validation rmse = 0.056931
Epoch 24
Loss = 2.1023e-02, PNorm = 34.2286, GNorm = 1.8903, lr_0 = 1.1469e-04
Validation rmse = 0.058807
Epoch 25
Loss = 2.0197e-02, PNorm = 34.2306, GNorm = 0.7277, lr_0 = 1.0000e-04
Validation rmse = 0.047107
Epoch 26
Validation rmse = 0.046317
Epoch 27
Loss = 2.3994e-02, PNorm = 34.2328, GNorm = 0.6443, lr_0 = 1.0000e-04
Validation rmse = 0.045558
Epoch 28
Loss = 1.4498e-02, PNorm = 34.2348, GNorm = 0.3728, lr_0 = 1.0000e-04
Loss = 4.4235e-02, PNorm = 34.2350, GNorm = 1.6257, lr_0 = 1.0000e-04
Validation rmse = 0.045674
Epoch 29
Validation rmse = 0.047655
Model 0 best validation rmse = 0.045558 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.055902
Ensemble test rmse = 0.055902
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.270396
Epoch 1
Loss = 3.6348e-01, PNorm = 34.0356, GNorm = 4.0663, lr_0 = 1.0000e-03
Validation rmse = 0.231706
Epoch 2
Validation rmse = 0.187757
Epoch 3
Loss = 2.0102e-01, PNorm = 34.0805, GNorm = 1.1718, lr_0 = 8.4834e-04
Validation rmse = 0.166576
Epoch 4
Loss = 1.5701e-01, PNorm = 34.1086, GNorm = 1.0196, lr_0 = 7.2962e-04
Validation rmse = 0.159889
Epoch 5
Validation rmse = 0.139427
Epoch 6
Loss = 1.1482e-01, PNorm = 34.1371, GNorm = 3.9211, lr_0 = 6.2751e-04
Validation rmse = 0.111297
Epoch 7
Validation rmse = 0.105106
Epoch 8
Loss = 1.2792e-01, PNorm = 34.1575, GNorm = 1.0524, lr_0 = 5.3234e-04
Validation rmse = 0.100201
Epoch 9
Loss = 7.4187e-02, PNorm = 34.1739, GNorm = 0.4970, lr_0 = 4.6416e-04
Validation rmse = 0.080587
Epoch 10
Validation rmse = 0.082505
Epoch 11
Loss = 4.2506e-02, PNorm = 34.1898, GNorm = 0.6771, lr_0 = 3.9377e-04
Validation rmse = 0.078113
Epoch 12
Loss = 4.2591e-02, PNorm = 34.2010, GNorm = 2.1086, lr_0 = 3.3866e-04
Validation rmse = 0.080181
Epoch 13
Validation rmse = 0.069468
Epoch 14
Loss = 4.0271e-02, PNorm = 34.2095, GNorm = 3.0138, lr_0 = 2.9126e-04
Validation rmse = 0.088481
Epoch 15
Validation rmse = 0.069020
Epoch 16
Loss = 3.1943e-02, PNorm = 34.2155, GNorm = 0.9060, lr_0 = 2.4709e-04
Validation rmse = 0.069010
Epoch 17
Loss = 2.3741e-02, PNorm = 34.2209, GNorm = 0.4997, lr_0 = 2.1544e-04
Validation rmse = 0.065229
Epoch 18
Validation rmse = 0.063212
Epoch 19
Loss = 1.7346e-02, PNorm = 34.2265, GNorm = 0.6876, lr_0 = 1.8277e-04
Validation rmse = 0.060127
Epoch 20
Loss = 2.2248e-02, PNorm = 34.2306, GNorm = 0.5047, lr_0 = 1.5719e-04
Validation rmse = 0.061558
Epoch 21
Validation rmse = 0.061234
Epoch 22
Loss = 1.6916e-02, PNorm = 34.2333, GNorm = 0.8523, lr_0 = 1.3519e-04
Validation rmse = 0.060315
Epoch 23
Validation rmse = 0.058760
Epoch 24
Loss = 1.6713e-02, PNorm = 34.2360, GNorm = 1.3916, lr_0 = 1.1469e-04
Validation rmse = 0.059403
Epoch 25
Loss = 1.5279e-02, PNorm = 34.2382, GNorm = 1.1411, lr_0 = 1.0000e-04
Validation rmse = 0.056963
Epoch 26
Validation rmse = 0.060237
Epoch 27
Loss = 1.8870e-02, PNorm = 34.2401, GNorm = 0.6127, lr_0 = 1.0000e-04
Validation rmse = 0.056353
Epoch 28
Loss = 1.7129e-02, PNorm = 34.2416, GNorm = 0.3120, lr_0 = 1.0000e-04
Loss = 2.4059e-02, PNorm = 34.2418, GNorm = 1.7847, lr_0 = 1.0000e-04
Validation rmse = 0.059296
Epoch 29
Validation rmse = 0.056115
Model 0 best validation rmse = 0.056115 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.056671
Ensemble test rmse = 0.056671
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.233935
Epoch 1
Loss = 4.6429e-01, PNorm = 34.0363, GNorm = 4.3415, lr_0 = 1.0000e-03
Validation rmse = 0.168265
Epoch 2
Validation rmse = 0.141788
Epoch 3
Loss = 1.7557e-01, PNorm = 34.0811, GNorm = 1.0197, lr_0 = 8.4834e-04
Validation rmse = 0.127522
Epoch 4
Loss = 1.5640e-01, PNorm = 34.1123, GNorm = 2.7805, lr_0 = 7.2962e-04
Validation rmse = 0.123559
Epoch 5
Validation rmse = 0.104121
Epoch 6
Loss = 1.1123e-01, PNorm = 34.1401, GNorm = 0.5744, lr_0 = 6.2751e-04
Validation rmse = 0.097648
Epoch 7
Validation rmse = 0.088834
Epoch 8
Loss = 7.7614e-02, PNorm = 34.1661, GNorm = 0.6865, lr_0 = 5.3234e-04
Validation rmse = 0.082419
Epoch 9
Loss = 5.4041e-02, PNorm = 34.1838, GNorm = 1.3418, lr_0 = 4.6416e-04
Validation rmse = 0.086506
Epoch 10
Validation rmse = 0.073704
Epoch 11
Loss = 4.7097e-02, PNorm = 34.1957, GNorm = 4.5539, lr_0 = 3.9377e-04
Validation rmse = 0.090654
Epoch 12
Loss = 5.6615e-02, PNorm = 34.2048, GNorm = 3.8230, lr_0 = 3.3866e-04
Validation rmse = 0.062653
Epoch 13
Validation rmse = 0.067393
Epoch 14
Loss = 3.6112e-02, PNorm = 34.2124, GNorm = 1.6932, lr_0 = 2.9126e-04
Validation rmse = 0.066322
Epoch 15
Validation rmse = 0.064946
Epoch 16
Loss = 3.3403e-02, PNorm = 34.2199, GNorm = 1.1806, lr_0 = 2.4709e-04
Validation rmse = 0.061870
Epoch 17
Loss = 2.4763e-02, PNorm = 34.2249, GNorm = 0.7020, lr_0 = 2.1544e-04
Validation rmse = 0.062841
Epoch 18
Validation rmse = 0.062351
Epoch 19
Loss = 2.0723e-02, PNorm = 34.2294, GNorm = 0.6583, lr_0 = 1.8277e-04
Validation rmse = 0.062351
Epoch 20
Loss = 1.8998e-02, PNorm = 34.2329, GNorm = 0.3751, lr_0 = 1.5719e-04
Validation rmse = 0.059542
Epoch 21
Validation rmse = 0.059659
Epoch 22
Loss = 1.7906e-02, PNorm = 34.2358, GNorm = 0.1906, lr_0 = 1.3519e-04
Validation rmse = 0.060171
Epoch 23
Validation rmse = 0.059128
Epoch 24
Loss = 2.5433e-02, PNorm = 34.2387, GNorm = 0.2526, lr_0 = 1.1469e-04
Validation rmse = 0.060341
Epoch 25
Loss = 1.7791e-02, PNorm = 34.2406, GNorm = 0.6430, lr_0 = 1.0000e-04
Validation rmse = 0.060127
Epoch 26
Validation rmse = 0.058273
Epoch 27
Loss = 1.5250e-02, PNorm = 34.2429, GNorm = 0.9804, lr_0 = 1.0000e-04
Validation rmse = 0.058335
Epoch 28
Loss = 1.6483e-02, PNorm = 34.2458, GNorm = 0.5621, lr_0 = 1.0000e-04
Loss = 7.1196e-03, PNorm = 34.2460, GNorm = 1.3939, lr_0 = 1.0000e-04
Validation rmse = 0.059827
Epoch 29
Validation rmse = 0.059045
Model 0 best validation rmse = 0.058273 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.067995
Ensemble test rmse = 0.067995
5-fold cross validation
	Seed 0 ==> test rmse = 0.100295
	Seed 1 ==> test rmse = 0.050819
	Seed 2 ==> test rmse = 0.055902
	Seed 3 ==> test rmse = 0.056671
	Seed 4 ==> test rmse = 0.067995
Overall test rmse = 0.066336 +/- 0.017883
Elapsed time = 0:01:50
Command line
python C:\Users\wanne\AppData\Local\Programs\Python\Python310\Scripts\chemprop_train --data_path ./csv_files/Polymers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/Polymers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.490594
Epoch 1
Loss = 4.9524e-01, PNorm = 34.0367, GNorm = 5.8949, lr_0 = 1.0000e-03
Validation r2 = 0.771756
Epoch 2
Validation r2 = 0.785258
Epoch 3
Loss = 1.9783e-01, PNorm = 34.0841, GNorm = 0.5301, lr_0 = 8.4834e-04
Validation r2 = 0.830818
Epoch 4
Loss = 1.5894e-01, PNorm = 34.1166, GNorm = 0.6723, lr_0 = 7.2962e-04
Validation r2 = 0.837998
Epoch 5
Validation r2 = 0.886153
Epoch 6
Loss = 9.1617e-02, PNorm = 34.1410, GNorm = 0.6622, lr_0 = 6.2751e-04
Validation r2 = 0.891449
Epoch 7
Validation r2 = 0.915794
Epoch 8
Loss = 2.7033e-02, PNorm = 34.1663, GNorm = 1.5388, lr_0 = 5.3234e-04
Validation r2 = 0.928974
Epoch 9
Loss = 6.0310e-02, PNorm = 34.1833, GNorm = 1.1763, lr_0 = 4.6416e-04
Validation r2 = 0.935106
Epoch 10
Validation r2 = 0.945230
Epoch 11
Loss = 4.8576e-02, PNorm = 34.1980, GNorm = 3.0190, lr_0 = 3.9377e-04
Validation r2 = 0.945413
Epoch 12
Loss = 4.0376e-02, PNorm = 34.2081, GNorm = 2.1901, lr_0 = 3.3866e-04
Validation r2 = 0.962781
Epoch 13
Validation r2 = 0.961506
Epoch 14
Loss = 2.9638e-02, PNorm = 34.2176, GNorm = 1.5122, lr_0 = 2.9126e-04
Validation r2 = 0.960369
Epoch 15
Validation r2 = 0.968309
Epoch 16
Loss = 2.7263e-02, PNorm = 34.2254, GNorm = 0.4222, lr_0 = 2.4709e-04
Validation r2 = 0.970425
Epoch 17
Loss = 1.3779e-02, PNorm = 34.2301, GNorm = 0.8317, lr_0 = 2.1544e-04
Validation r2 = 0.971977
Epoch 18
Validation r2 = 0.972882
Epoch 19
Loss = 2.2177e-02, PNorm = 34.2347, GNorm = 1.1778, lr_0 = 1.8277e-04
Validation r2 = 0.973925
Epoch 20
Loss = 2.1519e-02, PNorm = 34.2381, GNorm = 1.5615, lr_0 = 1.5719e-04
Validation r2 = 0.974466
Epoch 21
Validation r2 = 0.972083
Epoch 22
Loss = 1.7815e-02, PNorm = 34.2411, GNorm = 0.7914, lr_0 = 1.3519e-04
Validation r2 = 0.976076
Epoch 23
Validation r2 = 0.975405
Epoch 24
Loss = 1.4564e-02, PNorm = 34.2439, GNorm = 0.4033, lr_0 = 1.1469e-04
Validation r2 = 0.976980
Epoch 25
Loss = 1.8541e-02, PNorm = 34.2460, GNorm = 1.4425, lr_0 = 1.0000e-04
Validation r2 = 0.976680
Epoch 26
Validation r2 = 0.975363
Epoch 27
Loss = 1.4505e-02, PNorm = 34.2485, GNorm = 0.2266, lr_0 = 1.0000e-04
Validation r2 = 0.976939
Epoch 28
Loss = 1.6110e-02, PNorm = 34.2508, GNorm = 0.6797, lr_0 = 1.0000e-04
Loss = 1.1988e-02, PNorm = 34.2509, GNorm = 0.6031, lr_0 = 1.0000e-04
Validation r2 = 0.978725
Epoch 29
Validation r2 = 0.977904
Model 0 best validation r2 = 0.978725 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.940206
Ensemble test r2 = 0.940206
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.608807
Epoch 1
Loss = 4.1795e-01, PNorm = 34.0376, GNorm = 1.5927, lr_0 = 1.0000e-03
Validation r2 = 0.713398
Epoch 2
Validation r2 = 0.761033
Epoch 3
Loss = 1.5872e-01, PNorm = 34.0896, GNorm = 2.2771, lr_0 = 8.4834e-04
Validation r2 = 0.654372
Epoch 4
Loss = 1.4736e-01, PNorm = 34.1228, GNorm = 0.7535, lr_0 = 7.2962e-04
Validation r2 = 0.759359
Epoch 5
Validation r2 = 0.840587
Epoch 6
Loss = 9.2302e-02, PNorm = 34.1491, GNorm = 1.6146, lr_0 = 6.2751e-04
Validation r2 = 0.860262
Epoch 7
Validation r2 = 0.831200
Epoch 8
Loss = 6.9239e-02, PNorm = 34.1743, GNorm = 3.3022, lr_0 = 5.3234e-04
Validation r2 = 0.893487
Epoch 9
Loss = 4.1668e-02, PNorm = 34.1901, GNorm = 0.3463, lr_0 = 4.6416e-04
Validation r2 = 0.896726
Epoch 10
Validation r2 = 0.907635
Epoch 11
Loss = 4.0361e-02, PNorm = 34.2036, GNorm = 1.5672, lr_0 = 3.9377e-04
Validation r2 = 0.919181
Epoch 12
Loss = 3.1749e-02, PNorm = 34.2126, GNorm = 3.1962, lr_0 = 3.3866e-04
Validation r2 = 0.919621
Epoch 13
Validation r2 = 0.924396
Epoch 14
Loss = 2.0363e-02, PNorm = 34.2190, GNorm = 0.2436, lr_0 = 2.9126e-04
Validation r2 = 0.937064
Epoch 15
Validation r2 = 0.941478
Epoch 16
Loss = 2.2169e-02, PNorm = 34.2257, GNorm = 0.7254, lr_0 = 2.4709e-04
Validation r2 = 0.941992
Epoch 17
Loss = 1.8420e-02, PNorm = 34.2305, GNorm = 1.2849, lr_0 = 2.1544e-04
Validation r2 = 0.924785
Epoch 18
Validation r2 = 0.943320
Epoch 19
Loss = 1.5132e-02, PNorm = 34.2339, GNorm = 1.2577, lr_0 = 1.8277e-04
Validation r2 = 0.932292
Epoch 20
Loss = 1.7073e-02, PNorm = 34.2364, GNorm = 0.8561, lr_0 = 1.5719e-04
Validation r2 = 0.943805
Epoch 21
Validation r2 = 0.940925
Epoch 22
Loss = 1.6229e-02, PNorm = 34.2398, GNorm = 1.5302, lr_0 = 1.3519e-04
Validation r2 = 0.950621
Epoch 23
Validation r2 = 0.950994
Epoch 24
Loss = 1.3637e-02, PNorm = 34.2419, GNorm = 0.6766, lr_0 = 1.1469e-04
Validation r2 = 0.951263
Epoch 25
Loss = 1.0752e-02, PNorm = 34.2435, GNorm = 0.6842, lr_0 = 1.0000e-04
Validation r2 = 0.953676
Epoch 26
Validation r2 = 0.954006
Epoch 27
Loss = 1.1614e-02, PNorm = 34.2455, GNorm = 0.7464, lr_0 = 1.0000e-04
Validation r2 = 0.955275
Epoch 28
Loss = 1.3119e-02, PNorm = 34.2474, GNorm = 0.6189, lr_0 = 1.0000e-04
Loss = 9.1975e-03, PNorm = 34.2476, GNorm = 0.7917, lr_0 = 1.0000e-04
Validation r2 = 0.949877
Epoch 29
Validation r2 = 0.954767
Model 0 best validation r2 = 0.955275 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.984988
Ensemble test r2 = 0.984988
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.600550
Epoch 1
Loss = 3.7305e-01, PNorm = 34.0380, GNorm = 4.0471, lr_0 = 1.0000e-03
Validation r2 = 0.722782
Epoch 2
Validation r2 = 0.703694
Epoch 3
Loss = 1.4358e-01, PNorm = 34.0912, GNorm = 1.3859, lr_0 = 8.4834e-04
Validation r2 = 0.823836
Epoch 4
Loss = 1.4428e-01, PNorm = 34.1190, GNorm = 1.3901, lr_0 = 7.2962e-04
Validation r2 = 0.859146
Epoch 5
Validation r2 = 0.894534
Epoch 6
Loss = 8.0058e-02, PNorm = 34.1417, GNorm = 1.5776, lr_0 = 6.2751e-04
Validation r2 = 0.912332
Epoch 7
Validation r2 = 0.917402
Epoch 8
Loss = 6.8895e-02, PNorm = 34.1629, GNorm = 3.0916, lr_0 = 5.3234e-04
Validation r2 = 0.933104
Epoch 9
Loss = 5.4840e-02, PNorm = 34.1760, GNorm = 3.1879, lr_0 = 4.6416e-04
Validation r2 = 0.929290
Epoch 10
Validation r2 = 0.950602
Epoch 11
Loss = 4.5203e-02, PNorm = 34.1893, GNorm = 2.5113, lr_0 = 3.9377e-04
Validation r2 = 0.950371
Epoch 12
Loss = 3.3131e-02, PNorm = 34.1986, GNorm = 1.0398, lr_0 = 3.3866e-04
Validation r2 = 0.955991
Epoch 13
Validation r2 = 0.952867
Epoch 14
Loss = 2.3628e-02, PNorm = 34.2055, GNorm = 0.5169, lr_0 = 2.9126e-04
Validation r2 = 0.960327
Epoch 15
Validation r2 = 0.965731
Epoch 16
Loss = 1.6729e-02, PNorm = 34.2116, GNorm = 1.2696, lr_0 = 2.4709e-04
Validation r2 = 0.966244
Epoch 17
Loss = 2.2852e-02, PNorm = 34.2156, GNorm = 0.3260, lr_0 = 2.1544e-04
Validation r2 = 0.969177
Epoch 18
Validation r2 = 0.970488
Epoch 19
Loss = 2.0986e-02, PNorm = 34.2200, GNorm = 0.6456, lr_0 = 1.8277e-04
Validation r2 = 0.971149
Epoch 20
Loss = 1.9108e-02, PNorm = 34.2232, GNorm = 0.7060, lr_0 = 1.5719e-04
Validation r2 = 0.972013
Epoch 21
Validation r2 = 0.968282
Epoch 22
Loss = 2.0893e-02, PNorm = 34.2259, GNorm = 1.1869, lr_0 = 1.3519e-04
Validation r2 = 0.972572
Epoch 23
Validation r2 = 0.967208
Epoch 24
Loss = 2.1023e-02, PNorm = 34.2286, GNorm = 1.8903, lr_0 = 1.1469e-04
Validation r2 = 0.965011
Epoch 25
Loss = 2.0197e-02, PNorm = 34.2306, GNorm = 0.7277, lr_0 = 1.0000e-04
Validation r2 = 0.977549
Epoch 26
Validation r2 = 0.978295
Epoch 27
Loss = 2.3994e-02, PNorm = 34.2328, GNorm = 0.6443, lr_0 = 1.0000e-04
Validation r2 = 0.979001
Epoch 28
Loss = 1.4498e-02, PNorm = 34.2348, GNorm = 0.3728, lr_0 = 1.0000e-04
Loss = 4.4235e-02, PNorm = 34.2350, GNorm = 1.6257, lr_0 = 1.0000e-04
Validation r2 = 0.978894
Epoch 29
Validation r2 = 0.977023
Model 0 best validation r2 = 0.979001 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.965575
Ensemble test r2 = 0.965575
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.320258
Epoch 1
Loss = 3.6348e-01, PNorm = 34.0356, GNorm = 4.0663, lr_0 = 1.0000e-03
Validation r2 = 0.500866
Epoch 2
Validation r2 = 0.672257
Epoch 3
Loss = 2.0102e-01, PNorm = 34.0805, GNorm = 1.1718, lr_0 = 8.4834e-04
Validation r2 = 0.742031
Epoch 4
Loss = 1.5701e-01, PNorm = 34.1086, GNorm = 1.0196, lr_0 = 7.2962e-04
Validation r2 = 0.762327
Epoch 5
Validation r2 = 0.819268
Epoch 6
Loss = 1.1482e-01, PNorm = 34.1371, GNorm = 3.9211, lr_0 = 6.2751e-04
Validation r2 = 0.884839
Epoch 7
Validation r2 = 0.897294
Epoch 8
Loss = 1.2792e-01, PNorm = 34.1575, GNorm = 1.0524, lr_0 = 5.3234e-04
Validation r2 = 0.906657
Epoch 9
Loss = 7.4187e-02, PNorm = 34.1739, GNorm = 0.4970, lr_0 = 4.6416e-04
Validation r2 = 0.939623
Epoch 10
Validation r2 = 0.936714
Epoch 11
Loss = 4.2506e-02, PNorm = 34.1898, GNorm = 0.6771, lr_0 = 3.9377e-04
Validation r2 = 0.943273
Epoch 12
Loss = 4.2591e-02, PNorm = 34.2010, GNorm = 2.1086, lr_0 = 3.3866e-04
Validation r2 = 0.940229
Epoch 13
Validation r2 = 0.955135
Epoch 14
Loss = 4.0271e-02, PNorm = 34.2095, GNorm = 3.0138, lr_0 = 2.9126e-04
Validation r2 = 0.927214
Epoch 15
Validation r2 = 0.955712
Epoch 16
Loss = 3.1943e-02, PNorm = 34.2155, GNorm = 0.9060, lr_0 = 2.4709e-04
Validation r2 = 0.955724
Epoch 17
Loss = 2.3741e-02, PNorm = 34.2209, GNorm = 0.4997, lr_0 = 2.1544e-04
Validation r2 = 0.960443
Epoch 18
Validation r2 = 0.962851
Epoch 19
Loss = 1.7346e-02, PNorm = 34.2265, GNorm = 0.6876, lr_0 = 1.8277e-04
Validation r2 = 0.966390
Epoch 20
Loss = 2.2248e-02, PNorm = 34.2306, GNorm = 0.5047, lr_0 = 1.5719e-04
Validation r2 = 0.964770
Epoch 21
Validation r2 = 0.965140
Epoch 22
Loss = 1.6916e-02, PNorm = 34.2333, GNorm = 0.8523, lr_0 = 1.3519e-04
Validation r2 = 0.966179
Epoch 23
Validation r2 = 0.967900
Epoch 24
Loss = 1.6713e-02, PNorm = 34.2360, GNorm = 1.3916, lr_0 = 1.1469e-04
Validation r2 = 0.967194
Epoch 25
Loss = 1.5279e-02, PNorm = 34.2382, GNorm = 1.1411, lr_0 = 1.0000e-04
Validation r2 = 0.969833
Epoch 26
Validation r2 = 0.966265
Epoch 27
Loss = 1.8870e-02, PNorm = 34.2401, GNorm = 0.6127, lr_0 = 1.0000e-04
Validation r2 = 0.970476
Epoch 28
Loss = 1.7129e-02, PNorm = 34.2416, GNorm = 0.3120, lr_0 = 1.0000e-04
Loss = 2.4059e-02, PNorm = 34.2418, GNorm = 1.7847, lr_0 = 1.0000e-04
Validation r2 = 0.967311
Epoch 29
Validation r2 = 0.970725
Model 0 best validation r2 = 0.970725 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.976152
Ensemble test r2 = 0.976152
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.550045
Epoch 1
Loss = 4.6429e-01, PNorm = 34.0363, GNorm = 4.3415, lr_0 = 1.0000e-03
Validation r2 = 0.767209
Epoch 2
Validation r2 = 0.834706
Epoch 3
Loss = 1.7557e-01, PNorm = 34.0811, GNorm = 1.0197, lr_0 = 8.4834e-04
Validation r2 = 0.866294
Epoch 4
Loss = 1.5640e-01, PNorm = 34.1123, GNorm = 2.7805, lr_0 = 7.2962e-04
Validation r2 = 0.874475
Epoch 5
Validation r2 = 0.910864
Epoch 6
Loss = 1.1123e-01, PNorm = 34.1401, GNorm = 0.5744, lr_0 = 6.2751e-04
Validation r2 = 0.921602
Epoch 7
Validation r2 = 0.935116
Epoch 8
Loss = 7.7614e-02, PNorm = 34.1661, GNorm = 0.6865, lr_0 = 5.3234e-04
Validation r2 = 0.944148
Epoch 9
Loss = 5.4041e-02, PNorm = 34.1838, GNorm = 1.3418, lr_0 = 4.6416e-04
Validation r2 = 0.938472
Epoch 10
Validation r2 = 0.955335
Epoch 11
Loss = 4.7097e-02, PNorm = 34.1957, GNorm = 4.5539, lr_0 = 3.9377e-04
Validation r2 = 0.932431
Epoch 12
Loss = 5.6615e-02, PNorm = 34.2048, GNorm = 3.8230, lr_0 = 3.3866e-04
Validation r2 = 0.967725
Epoch 13
Validation r2 = 0.962657
Epoch 14
Loss = 3.6112e-02, PNorm = 34.2124, GNorm = 1.6932, lr_0 = 2.9126e-04
Validation r2 = 0.963834
Epoch 15
Validation r2 = 0.965320
Epoch 16
Loss = 3.3403e-02, PNorm = 34.2199, GNorm = 1.1806, lr_0 = 2.4709e-04
Validation r2 = 0.968527
Epoch 17
Loss = 2.4763e-02, PNorm = 34.2249, GNorm = 0.7020, lr_0 = 2.1544e-04
Validation r2 = 0.967532
Epoch 18
Validation r2 = 0.968035
Epoch 19
Loss = 2.0723e-02, PNorm = 34.2294, GNorm = 0.6583, lr_0 = 1.8277e-04
Validation r2 = 0.968036
Epoch 20
Loss = 1.8998e-02, PNorm = 34.2329, GNorm = 0.3751, lr_0 = 1.5719e-04
Validation r2 = 0.970850
Epoch 21
Validation r2 = 0.970736
Epoch 22
Loss = 1.7906e-02, PNorm = 34.2358, GNorm = 0.1906, lr_0 = 1.3519e-04
Validation r2 = 0.970232
Epoch 23
Validation r2 = 0.971255
Epoch 24
Loss = 2.5433e-02, PNorm = 34.2387, GNorm = 0.2526, lr_0 = 1.1469e-04
Validation r2 = 0.970063
Epoch 25
Loss = 1.7791e-02, PNorm = 34.2406, GNorm = 0.6430, lr_0 = 1.0000e-04
Validation r2 = 0.970275
Epoch 26
Validation r2 = 0.972080
Epoch 27
Loss = 1.5250e-02, PNorm = 34.2429, GNorm = 0.9804, lr_0 = 1.0000e-04
Validation r2 = 0.972021
Epoch 28
Loss = 1.6483e-02, PNorm = 34.2458, GNorm = 0.5621, lr_0 = 1.0000e-04
Loss = 7.1196e-03, PNorm = 34.2460, GNorm = 1.3939, lr_0 = 1.0000e-04
Validation r2 = 0.970571
Epoch 29
Validation r2 = 0.971335
Model 0 best validation r2 = 0.972080 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.961520
Ensemble test r2 = 0.961520
5-fold cross validation
	Seed 0 ==> test r2 = 0.940206
	Seed 1 ==> test r2 = 0.984988
	Seed 2 ==> test r2 = 0.965575
	Seed 3 ==> test r2 = 0.976152
	Seed 4 ==> test r2 = 0.961520
Overall test r2 = 0.965688 +/- 0.015157
Elapsed time = 0:01:38
Command line
python ./chemprop/train.py --data_path ./csv_files/Polymers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/Polymers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573635
Epoch 1
Loss = 4.0732e-01, PNorm = 34.0308, GNorm = 3.8868, lr_0 = 1.0000e-03
Validation r2 = 0.766555
Epoch 2
Validation r2 = 0.838974
Epoch 3
Loss = 2.0783e-01, PNorm = 34.0632, GNorm = 6.0915, lr_0 = 8.4834e-04
Validation r2 = 0.871292
Epoch 4
Loss = 1.6689e-01, PNorm = 34.0856, GNorm = 1.0182, lr_0 = 7.2962e-04
Validation r2 = 0.826266
Epoch 5
Validation r2 = 0.898616
Epoch 6
Loss = 8.6768e-02, PNorm = 34.1060, GNorm = 2.5587, lr_0 = 6.2751e-04
Validation r2 = 0.912944
Epoch 7
Validation r2 = 0.920694
Epoch 8
Loss = 2.7497e-02, PNorm = 34.1289, GNorm = 1.8941, lr_0 = 5.3234e-04
Validation r2 = 0.938624
Epoch 9
Loss = 4.3814e-02, PNorm = 34.1470, GNorm = 0.8257, lr_0 = 4.6416e-04
Validation r2 = 0.944418
Epoch 10
Validation r2 = 0.947835
Epoch 11
Loss = 3.7444e-02, PNorm = 34.1614, GNorm = 3.5345, lr_0 = 3.9377e-04
Validation r2 = 0.952106
Epoch 12
Loss = 2.6658e-02, PNorm = 34.1707, GNorm = 2.4614, lr_0 = 3.3866e-04
Validation r2 = 0.963150
Epoch 13
Validation r2 = 0.962775
Epoch 14
Loss = 1.7791e-02, PNorm = 34.1783, GNorm = 0.9264, lr_0 = 2.9126e-04
Validation r2 = 0.965389
Epoch 15
Validation r2 = 0.969756
Epoch 16
Loss = 1.2964e-02, PNorm = 34.1841, GNorm = 0.2949, lr_0 = 2.4709e-04
Validation r2 = 0.971447
Epoch 17
Loss = 7.3929e-03, PNorm = 34.1879, GNorm = 0.2671, lr_0 = 2.1544e-04
Validation r2 = 0.972824
Epoch 18
Validation r2 = 0.973224
Epoch 19
Loss = 1.9082e-02, PNorm = 34.1911, GNorm = 2.6334, lr_0 = 1.8277e-04
Validation r2 = 0.974480
Epoch 20
Loss = 1.4617e-02, PNorm = 34.1933, GNorm = 2.6698, lr_0 = 1.5719e-04
Validation r2 = 0.973455
Epoch 21
Validation r2 = 0.974315
Epoch 22
Loss = 1.4597e-02, PNorm = 34.1953, GNorm = 0.7439, lr_0 = 1.3519e-04
Validation r2 = 0.977277
Epoch 23
Validation r2 = 0.977622
Epoch 24
Loss = 9.3544e-03, PNorm = 34.1974, GNorm = 0.2259, lr_0 = 1.1469e-04
Validation r2 = 0.977693
Epoch 25
Loss = 1.1268e-02, PNorm = 34.1988, GNorm = 1.8664, lr_0 = 1.0000e-04
Validation r2 = 0.978316
Epoch 26
Validation r2 = 0.978153
Epoch 27
Loss = 9.3138e-03, PNorm = 34.2006, GNorm = 0.2055, lr_0 = 1.0000e-04
Validation r2 = 0.979989
Epoch 28
Loss = 8.3329e-03, PNorm = 34.2021, GNorm = 0.2526, lr_0 = 1.0000e-04
Loss = 4.1564e-03, PNorm = 34.2022, GNorm = 0.5480, lr_0 = 1.0000e-04
Validation r2 = 0.980446
Epoch 29
Validation r2 = 0.980744
Model 0 best validation r2 = 0.980744 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.968943
Ensemble test r2 = 0.968943
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.599386
Epoch 1
Loss = 4.5551e-01, PNorm = 34.0314, GNorm = 16.1830, lr_0 = 1.0000e-03
Validation r2 = 0.790042
Epoch 2
Validation r2 = 0.842139
Epoch 3
Loss = 1.7934e-01, PNorm = 34.0673, GNorm = 4.8361, lr_0 = 8.4834e-04
Validation r2 = 0.871593
Epoch 4
Loss = 1.8540e-01, PNorm = 34.0901, GNorm = 0.8777, lr_0 = 7.2962e-04
Validation r2 = 0.759882
Epoch 5
Validation r2 = 0.888048
Epoch 6
Loss = 1.1832e-01, PNorm = 34.1134, GNorm = 3.1469, lr_0 = 6.2751e-04
Validation r2 = 0.848108
Epoch 7
Validation r2 = 0.894699
Epoch 8
Loss = 8.3449e-02, PNorm = 34.1358, GNorm = 1.7009, lr_0 = 5.3234e-04
Validation r2 = 0.928936
Epoch 9
Loss = 4.9928e-02, PNorm = 34.1537, GNorm = 2.4468, lr_0 = 4.6416e-04
Validation r2 = 0.918774
Epoch 10
Validation r2 = 0.922338
Epoch 11
Loss = 4.4093e-02, PNorm = 34.1688, GNorm = 2.7365, lr_0 = 3.9377e-04
Validation r2 = 0.948223
Epoch 12
Loss = 2.2729e-02, PNorm = 34.1788, GNorm = 0.8159, lr_0 = 3.3866e-04
Validation r2 = 0.955790
Epoch 13
Validation r2 = 0.954074
Epoch 14
Loss = 1.6776e-02, PNorm = 34.1865, GNorm = 0.3069, lr_0 = 2.9126e-04
Validation r2 = 0.957789
Epoch 15
Validation r2 = 0.961307
Epoch 16
Loss = 1.9600e-02, PNorm = 34.1931, GNorm = 0.4563, lr_0 = 2.4709e-04
Validation r2 = 0.970709
Epoch 17
Loss = 1.3360e-02, PNorm = 34.1982, GNorm = 0.6259, lr_0 = 2.1544e-04
Validation r2 = 0.965460
Epoch 18
Validation r2 = 0.971202
Epoch 19
Loss = 8.1413e-03, PNorm = 34.2025, GNorm = 0.4685, lr_0 = 1.8277e-04
Validation r2 = 0.967340
Epoch 20
Loss = 1.0332e-02, PNorm = 34.2050, GNorm = 0.5349, lr_0 = 1.5719e-04
Validation r2 = 0.969009
Epoch 21
Validation r2 = 0.968373
Epoch 22
Loss = 9.1522e-03, PNorm = 34.2081, GNorm = 0.8355, lr_0 = 1.3519e-04
Validation r2 = 0.976376
Epoch 23
Validation r2 = 0.965850
Epoch 24
Loss = 1.0040e-02, PNorm = 34.2103, GNorm = 0.7222, lr_0 = 1.1469e-04
Validation r2 = 0.975096
Epoch 25
Loss = 6.1949e-03, PNorm = 34.2123, GNorm = 1.0822, lr_0 = 1.0000e-04
Validation r2 = 0.976462
Epoch 26
Validation r2 = 0.975596
Epoch 27
Loss = 9.0889e-03, PNorm = 34.2144, GNorm = 0.6331, lr_0 = 1.0000e-04
Validation r2 = 0.977532
Epoch 28
Loss = 7.1361e-03, PNorm = 34.2165, GNorm = 0.4173, lr_0 = 1.0000e-04
Loss = 5.4490e-03, PNorm = 34.2167, GNorm = 1.5344, lr_0 = 1.0000e-04
Validation r2 = 0.978620
Epoch 29
Validation r2 = 0.976272
Model 0 best validation r2 = 0.978620 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991820
Ensemble test r2 = 0.991820
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.691167
Epoch 1
Loss = 2.9264e-01, PNorm = 34.0308, GNorm = 3.2897, lr_0 = 1.0000e-03
Validation r2 = 0.733268
Epoch 2
Validation r2 = 0.760222
Epoch 3
Loss = 1.4465e-01, PNorm = 34.0675, GNorm = 3.5673, lr_0 = 8.4834e-04
Validation r2 = 0.831569
Epoch 4
Loss = 1.1255e-01, PNorm = 34.0934, GNorm = 5.1881, lr_0 = 7.2962e-04
Validation r2 = 0.748199
Epoch 5
Validation r2 = 0.851853
Epoch 6
Loss = 1.0746e-01, PNorm = 34.1106, GNorm = 5.9695, lr_0 = 6.2751e-04
Validation r2 = 0.870190
Epoch 7
Validation r2 = 0.922673
Epoch 8
Loss = 4.6097e-02, PNorm = 34.1237, GNorm = 0.6533, lr_0 = 5.3234e-04
Validation r2 = 0.930392
Epoch 9
Loss = 3.3392e-02, PNorm = 34.1366, GNorm = 1.9340, lr_0 = 4.6416e-04
Validation r2 = 0.944514
Epoch 10
Validation r2 = 0.950440
Epoch 11
Loss = 1.9874e-02, PNorm = 34.1493, GNorm = 0.7251, lr_0 = 3.9377e-04
Validation r2 = 0.955992
Epoch 12
Loss = 1.8196e-02, PNorm = 34.1565, GNorm = 0.6162, lr_0 = 3.3866e-04
Validation r2 = 0.960628
Epoch 13
Validation r2 = 0.962965
Epoch 14
Loss = 1.5607e-02, PNorm = 34.1610, GNorm = 0.7442, lr_0 = 2.9126e-04
Validation r2 = 0.963312
Epoch 15
Validation r2 = 0.971306
Epoch 16
Loss = 9.4105e-03, PNorm = 34.1649, GNorm = 0.1494, lr_0 = 2.4709e-04
Validation r2 = 0.972483
Epoch 17
Loss = 1.2791e-02, PNorm = 34.1674, GNorm = 0.5708, lr_0 = 2.1544e-04
Validation r2 = 0.974099
Epoch 18
Validation r2 = 0.972929
Epoch 19
Loss = 1.4036e-02, PNorm = 34.1705, GNorm = 0.8238, lr_0 = 1.8277e-04
Validation r2 = 0.976565
Epoch 20
Loss = 1.1074e-02, PNorm = 34.1729, GNorm = 0.3476, lr_0 = 1.5719e-04
Validation r2 = 0.975636
Epoch 21
Validation r2 = 0.976595
Epoch 22
Loss = 1.2668e-02, PNorm = 34.1744, GNorm = 2.1022, lr_0 = 1.3519e-04
Validation r2 = 0.977729
Epoch 23
Validation r2 = 0.977451
Epoch 24
Loss = 8.6141e-03, PNorm = 34.1763, GNorm = 0.9590, lr_0 = 1.1469e-04
Validation r2 = 0.979555
Epoch 25
Loss = 1.0335e-02, PNorm = 34.1781, GNorm = 1.0870, lr_0 = 1.0000e-04
Validation r2 = 0.982166
Epoch 26
Validation r2 = 0.982579
Epoch 27
Loss = 1.0322e-02, PNorm = 34.1797, GNorm = 0.3450, lr_0 = 1.0000e-04
Validation r2 = 0.982161
Epoch 28
Loss = 8.0901e-03, PNorm = 34.1810, GNorm = 0.2512, lr_0 = 1.0000e-04
Loss = 2.1964e-02, PNorm = 34.1812, GNorm = 1.4292, lr_0 = 1.0000e-04
Validation r2 = 0.980336
Epoch 29
Validation r2 = 0.982151
Model 0 best validation r2 = 0.982579 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.988009
Ensemble test r2 = 0.988009
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573855
Epoch 1
Loss = 3.3437e-01, PNorm = 34.0301, GNorm = 8.7927, lr_0 = 1.0000e-03
Validation r2 = 0.646637
Epoch 2
Validation r2 = 0.711635
Epoch 3
Loss = 2.4031e-01, PNorm = 34.0631, GNorm = 10.2145, lr_0 = 8.4834e-04
Validation r2 = 0.781623
Epoch 4
Loss = 1.6651e-01, PNorm = 34.0848, GNorm = 5.7196, lr_0 = 7.2962e-04
Validation r2 = 0.815695
Epoch 5
Validation r2 = 0.833713
Epoch 6
Loss = 1.0759e-01, PNorm = 34.1047, GNorm = 4.2482, lr_0 = 6.2751e-04
Validation r2 = 0.872905
Epoch 7
Validation r2 = 0.920961
Epoch 8
Loss = 8.9567e-02, PNorm = 34.1259, GNorm = 1.5528, lr_0 = 5.3234e-04
Validation r2 = 0.964139
Epoch 9
Loss = 4.3858e-02, PNorm = 34.1439, GNorm = 1.4386, lr_0 = 4.6416e-04
Validation r2 = 0.980910
Epoch 10
Validation r2 = 0.975929
Epoch 11
Loss = 2.0314e-02, PNorm = 34.1582, GNorm = 0.6164, lr_0 = 3.9377e-04
Validation r2 = 0.981965
Epoch 12
Loss = 1.8508e-02, PNorm = 34.1678, GNorm = 0.4706, lr_0 = 3.3866e-04
Validation r2 = 0.965875
Epoch 13
Validation r2 = 0.966932
Epoch 14
Loss = 2.0515e-02, PNorm = 34.1743, GNorm = 0.6786, lr_0 = 2.9126e-04
Validation r2 = 0.973357
Epoch 15
Validation r2 = 0.983405
Epoch 16
Loss = 1.0721e-02, PNorm = 34.1798, GNorm = 0.5766, lr_0 = 2.4709e-04
Validation r2 = 0.976880
Epoch 17
Loss = 1.1008e-02, PNorm = 34.1836, GNorm = 0.9138, lr_0 = 2.1544e-04
Validation r2 = 0.982892
Epoch 18
Validation r2 = 0.983126
Epoch 19
Loss = 7.3262e-03, PNorm = 34.1875, GNorm = 0.5719, lr_0 = 1.8277e-04
Validation r2 = 0.983067
Epoch 20
Loss = 9.4022e-03, PNorm = 34.1904, GNorm = 0.6497, lr_0 = 1.5719e-04
Validation r2 = 0.982921
Epoch 21
Validation r2 = 0.981510
Epoch 22
Loss = 8.6456e-03, PNorm = 34.1924, GNorm = 0.2918, lr_0 = 1.3519e-04
Validation r2 = 0.983492
Epoch 23
Validation r2 = 0.982361
Epoch 24
Loss = 1.1873e-02, PNorm = 34.1945, GNorm = 1.8218, lr_0 = 1.1469e-04
Validation r2 = 0.983282
Epoch 25
Loss = 6.8997e-03, PNorm = 34.1961, GNorm = 0.9470, lr_0 = 1.0000e-04
Validation r2 = 0.985065
Epoch 26
Validation r2 = 0.984709
Epoch 27
Loss = 8.6639e-03, PNorm = 34.1977, GNorm = 1.8055, lr_0 = 1.0000e-04
Validation r2 = 0.985443
Epoch 28
Loss = 6.8863e-03, PNorm = 34.1989, GNorm = 0.4063, lr_0 = 1.0000e-04
Loss = 3.5295e-03, PNorm = 34.1990, GNorm = 0.4058, lr_0 = 1.0000e-04
Validation r2 = 0.985650
Epoch 29
Validation r2 = 0.985644
Model 0 best validation r2 = 0.985650 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991553
Ensemble test r2 = 0.991553
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.579424
Epoch 1
Loss = 3.5941e-01, PNorm = 34.0296, GNorm = 2.7011, lr_0 = 1.0000e-03
Validation r2 = 0.751844
Epoch 2
Validation r2 = 0.826631
Epoch 3
Loss = 2.1796e-01, PNorm = 34.0626, GNorm = 3.5091, lr_0 = 8.4834e-04
Validation r2 = 0.867047
Epoch 4
Loss = 1.5362e-01, PNorm = 34.0868, GNorm = 3.8505, lr_0 = 7.2962e-04
Validation r2 = 0.916895
Epoch 5
Validation r2 = 0.938662
Epoch 6
Loss = 1.1292e-01, PNorm = 34.1102, GNorm = 1.2028, lr_0 = 6.2751e-04
Validation r2 = 0.959495
Epoch 7
Validation r2 = 0.972531
Epoch 8
Loss = 5.8828e-02, PNorm = 34.1351, GNorm = 0.5699, lr_0 = 5.3234e-04
Validation r2 = 0.965137
Epoch 9
Loss = 3.3841e-02, PNorm = 34.1522, GNorm = 1.4634, lr_0 = 4.6416e-04
Validation r2 = 0.977506
Epoch 10
Validation r2 = 0.965826
Epoch 11
Loss = 3.1129e-02, PNorm = 34.1645, GNorm = 4.0756, lr_0 = 3.9377e-04
Validation r2 = 0.980807
Epoch 12
Loss = 1.5232e-02, PNorm = 34.1713, GNorm = 0.2574, lr_0 = 3.3866e-04
Validation r2 = 0.981321
Epoch 13
Validation r2 = 0.988050
Epoch 14
Loss = 1.6028e-02, PNorm = 34.1765, GNorm = 2.2812, lr_0 = 2.9126e-04
Validation r2 = 0.987031
Epoch 15
Validation r2 = 0.985849
Epoch 16
Loss = 8.5342e-03, PNorm = 34.1800, GNorm = 0.7103, lr_0 = 2.4709e-04
Validation r2 = 0.985763
Epoch 17
Loss = 1.0411e-02, PNorm = 34.1828, GNorm = 0.8029, lr_0 = 2.1544e-04
Validation r2 = 0.987620
Epoch 18
Validation r2 = 0.988438
Epoch 19
Loss = 8.4644e-03, PNorm = 34.1858, GNorm = 0.2579, lr_0 = 1.8277e-04
Validation r2 = 0.987417
Epoch 20
Loss = 7.9774e-03, PNorm = 34.1878, GNorm = 1.2829, lr_0 = 1.5719e-04
Validation r2 = 0.988023
Epoch 21
Validation r2 = 0.989097
Epoch 22
Loss = 6.3970e-03, PNorm = 34.1897, GNorm = 0.8511, lr_0 = 1.3519e-04
Validation r2 = 0.989879
Epoch 23
Validation r2 = 0.989853
Epoch 24
Loss = 5.2683e-03, PNorm = 34.1917, GNorm = 0.2997, lr_0 = 1.1469e-04
Validation r2 = 0.990055
Epoch 25
Loss = 6.3018e-03, PNorm = 34.1931, GNorm = 0.1126, lr_0 = 1.0000e-04
Validation r2 = 0.988737
Epoch 26
Validation r2 = 0.990402
Epoch 27
Loss = 5.1890e-03, PNorm = 34.1946, GNorm = 0.9949, lr_0 = 1.0000e-04
Validation r2 = 0.989937
Epoch 28
Loss = 5.3544e-03, PNorm = 34.1962, GNorm = 0.0834, lr_0 = 1.0000e-04
Loss = 7.7945e-03, PNorm = 34.1964, GNorm = 0.7449, lr_0 = 1.0000e-04
Validation r2 = 0.989768
Epoch 29
Validation r2 = 0.990435
Model 0 best validation r2 = 0.990435 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.986382
Ensemble test r2 = 0.986382
5-fold cross validation
	Seed 0 ==> test r2 = 0.968943
	Seed 1 ==> test r2 = 0.991820
	Seed 2 ==> test r2 = 0.988009
	Seed 3 ==> test r2 = 0.991553
	Seed 4 ==> test r2 = 0.986382
Overall test r2 = 0.985341 +/- 0.008458
Elapsed time = 0:07:45
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric rmse
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.246668
Epoch 1
Loss = 4.0732e-01, PNorm = 34.0308, GNorm = 3.8868, lr_0 = 1.0000e-03
Validation rmse = 0.182522
Epoch 2
Validation rmse = 0.151590
Epoch 3
Loss = 2.0783e-01, PNorm = 34.0632, GNorm = 6.0915, lr_0 = 8.4834e-04
Validation rmse = 0.135527
Epoch 4
Loss = 1.6689e-01, PNorm = 34.0856, GNorm = 1.0182, lr_0 = 7.2962e-04
Validation rmse = 0.157458
Epoch 5
Validation rmse = 0.120284
Epoch 6
Loss = 8.6768e-02, PNorm = 34.1060, GNorm = 2.5587, lr_0 = 6.2751e-04
Validation rmse = 0.111461
Epoch 7
Validation rmse = 0.106384
Epoch 8
Loss = 2.7497e-02, PNorm = 34.1289, GNorm = 1.8941, lr_0 = 5.3234e-04
Validation rmse = 0.093588
Epoch 9
Loss = 4.3814e-02, PNorm = 34.1470, GNorm = 0.8257, lr_0 = 4.6416e-04
Validation rmse = 0.089062
Epoch 10
Validation rmse = 0.086280
Epoch 11
Loss = 3.7444e-02, PNorm = 34.1614, GNorm = 3.5345, lr_0 = 3.9377e-04
Validation rmse = 0.082673
Epoch 12
Loss = 2.6658e-02, PNorm = 34.1707, GNorm = 2.4614, lr_0 = 3.3866e-04
Validation rmse = 0.072517
Epoch 13
Validation rmse = 0.072886
Epoch 14
Loss = 1.7791e-02, PNorm = 34.1783, GNorm = 0.9271, lr_0 = 2.9126e-04
Validation rmse = 0.070281
Epoch 15
Validation rmse = 0.065696
Epoch 16
Loss = 1.2962e-02, PNorm = 34.1841, GNorm = 0.2951, lr_0 = 2.4709e-04
Validation rmse = 0.063829
Epoch 17
Loss = 7.3941e-03, PNorm = 34.1879, GNorm = 0.2675, lr_0 = 2.1544e-04
Validation rmse = 0.062269
Epoch 18
Validation rmse = 0.061811
Epoch 19
Loss = 1.9084e-02, PNorm = 34.1911, GNorm = 2.6326, lr_0 = 1.8277e-04
Validation rmse = 0.060345
Epoch 20
Loss = 1.4619e-02, PNorm = 34.1933, GNorm = 2.6697, lr_0 = 1.5719e-04
Validation rmse = 0.061539
Epoch 21
Validation rmse = 0.060550
Epoch 22
Loss = 1.4602e-02, PNorm = 34.1953, GNorm = 0.7436, lr_0 = 1.3519e-04
Validation rmse = 0.056937
Epoch 23
Validation rmse = 0.056502
Epoch 24
Loss = 9.3576e-03, PNorm = 34.1974, GNorm = 0.2251, lr_0 = 1.1469e-04
Validation rmse = 0.056428
Epoch 25
Loss = 1.1266e-02, PNorm = 34.1988, GNorm = 1.8616, lr_0 = 1.0000e-04
Validation rmse = 0.055616
Epoch 26
Validation rmse = 0.055837
Epoch 27
Loss = 9.3101e-03, PNorm = 34.2006, GNorm = 0.2072, lr_0 = 1.0000e-04
Validation rmse = 0.053454
Epoch 28
Loss = 8.3333e-03, PNorm = 34.2021, GNorm = 0.2513, lr_0 = 1.0000e-04
Loss = 4.1585e-03, PNorm = 34.2022, GNorm = 0.5450, lr_0 = 1.0000e-04
Validation rmse = 0.052817
Epoch 29
Validation rmse = 0.052405
Model 0 best validation rmse = 0.052405 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.072299
Ensemble test rmse = 0.072299
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.167118
Epoch 1
Loss = 4.5551e-01, PNorm = 34.0314, GNorm = 16.1830, lr_0 = 1.0000e-03
Validation rmse = 0.120983
Epoch 2
Validation rmse = 0.104905
Epoch 3
Loss = 1.7934e-01, PNorm = 34.0673, GNorm = 4.8361, lr_0 = 8.4834e-04
Validation rmse = 0.094613
Epoch 4
Loss = 1.8540e-01, PNorm = 34.0901, GNorm = 0.8777, lr_0 = 7.2962e-04
Validation rmse = 0.129382
Epoch 5
Validation rmse = 0.088360
Epoch 6
Loss = 1.1831e-01, PNorm = 34.1134, GNorm = 3.1457, lr_0 = 6.2751e-04
Validation rmse = 0.102884
Epoch 7
Validation rmse = 0.085644
Epoch 8
Loss = 8.3453e-02, PNorm = 34.1358, GNorm = 1.6985, lr_0 = 5.3234e-04
Validation rmse = 0.070337
Epoch 9
Loss = 4.9961e-02, PNorm = 34.1538, GNorm = 2.4447, lr_0 = 4.6416e-04
Validation rmse = 0.075310
Epoch 10
Validation rmse = 0.073505
Epoch 11
Loss = 4.4041e-02, PNorm = 34.1689, GNorm = 2.7500, lr_0 = 3.9377e-04
Validation rmse = 0.059891
Epoch 12
Loss = 2.2748e-02, PNorm = 34.1789, GNorm = 0.8247, lr_0 = 3.3866e-04
Validation rmse = 0.055490
Epoch 13
Validation rmse = 0.056444
Epoch 14
Loss = 1.6764e-02, PNorm = 34.1867, GNorm = 0.3186, lr_0 = 2.9126e-04
Validation rmse = 0.054071
Epoch 15
Validation rmse = 0.051815
Epoch 16
Loss = 1.9578e-02, PNorm = 34.1933, GNorm = 0.4583, lr_0 = 2.4709e-04
Validation rmse = 0.045174
Epoch 17
Loss = 1.3401e-02, PNorm = 34.1984, GNorm = 0.6268, lr_0 = 2.1544e-04
Validation rmse = 0.049384
Epoch 18
Validation rmse = 0.045093
Epoch 19
Loss = 8.1962e-03, PNorm = 34.2028, GNorm = 0.4034, lr_0 = 1.8277e-04
Validation rmse = 0.047675
Epoch 20
Loss = 1.0328e-02, PNorm = 34.2053, GNorm = 0.5582, lr_0 = 1.5719e-04
Validation rmse = 0.046310
Epoch 21
Validation rmse = 0.046911
Epoch 22
Loss = 9.1537e-03, PNorm = 34.2085, GNorm = 0.8273, lr_0 = 1.3519e-04
Validation rmse = 0.040530
Epoch 23
Validation rmse = 0.048792
Epoch 24
Loss = 1.0113e-02, PNorm = 34.2107, GNorm = 0.7537, lr_0 = 1.1469e-04
Validation rmse = 0.041419
Epoch 25
Loss = 6.1891e-03, PNorm = 34.2128, GNorm = 1.0754, lr_0 = 1.0000e-04
Validation rmse = 0.040451
Epoch 26
Validation rmse = 0.041152
Epoch 27
Loss = 9.1208e-03, PNorm = 34.2149, GNorm = 0.6204, lr_0 = 1.0000e-04
Validation rmse = 0.039484
Epoch 28
Loss = 7.1690e-03, PNorm = 34.2170, GNorm = 0.4040, lr_0 = 1.0000e-04
Loss = 5.4534e-03, PNorm = 34.2172, GNorm = 1.5433, lr_0 = 1.0000e-04
Validation rmse = 0.038693
Epoch 29
Validation rmse = 0.040628
Model 0 best validation rmse = 0.038693 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.037323
Ensemble test rmse = 0.037323
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.174713
Epoch 1
Loss = 2.9264e-01, PNorm = 34.0308, GNorm = 3.2897, lr_0 = 1.0000e-03
Validation rmse = 0.162368
Epoch 2
Validation rmse = 0.153946
Epoch 3
Loss = 1.4465e-01, PNorm = 34.0675, GNorm = 3.5673, lr_0 = 8.4834e-04
Validation rmse = 0.129025
Epoch 4
Loss = 1.1255e-01, PNorm = 34.0934, GNorm = 5.1881, lr_0 = 7.2962e-04
Validation rmse = 0.157758
Epoch 5
Validation rmse = 0.121007
Epoch 6
Loss = 1.0746e-01, PNorm = 34.1106, GNorm = 5.9695, lr_0 = 6.2751e-04
Validation rmse = 0.113271
Epoch 7
Validation rmse = 0.087424
Epoch 8
Loss = 4.6097e-02, PNorm = 34.1237, GNorm = 0.6533, lr_0 = 5.3234e-04
Validation rmse = 0.082946
Epoch 9
Loss = 3.3392e-02, PNorm = 34.1366, GNorm = 1.9340, lr_0 = 4.6416e-04
Validation rmse = 0.074055
Epoch 10
Validation rmse = 0.069989
Epoch 11
Loss = 1.9874e-02, PNorm = 34.1493, GNorm = 0.7251, lr_0 = 3.9377e-04
Validation rmse = 0.065952
Epoch 12
Loss = 1.8196e-02, PNorm = 34.1565, GNorm = 0.6162, lr_0 = 3.3866e-04
Validation rmse = 0.062382
Epoch 13
Validation rmse = 0.060502
Epoch 14
Loss = 1.5607e-02, PNorm = 34.1610, GNorm = 0.7442, lr_0 = 2.9126e-04
Validation rmse = 0.060217
Epoch 15
Validation rmse = 0.053254
Epoch 16
Loss = 9.4105e-03, PNorm = 34.1649, GNorm = 0.1494, lr_0 = 2.4709e-04
Validation rmse = 0.052151
Epoch 17
Loss = 1.2791e-02, PNorm = 34.1674, GNorm = 0.5709, lr_0 = 2.1544e-04
Validation rmse = 0.050593
Epoch 18
Validation rmse = 0.051718
Epoch 19
Loss = 1.4037e-02, PNorm = 34.1705, GNorm = 0.8257, lr_0 = 1.8277e-04
Validation rmse = 0.048125
Epoch 20
Loss = 1.1072e-02, PNorm = 34.1729, GNorm = 0.3490, lr_0 = 1.5719e-04
Validation rmse = 0.049045
Epoch 21
Validation rmse = 0.048071
Epoch 22
Loss = 1.2664e-02, PNorm = 34.1745, GNorm = 2.1083, lr_0 = 1.3519e-04
Validation rmse = 0.046905
Epoch 23
Validation rmse = 0.047226
Epoch 24
Loss = 8.6101e-03, PNorm = 34.1763, GNorm = 0.9587, lr_0 = 1.1469e-04
Validation rmse = 0.044988
Epoch 25
Loss = 1.0343e-02, PNorm = 34.1781, GNorm = 1.0876, lr_0 = 1.0000e-04
Validation rmse = 0.042008
Epoch 26
Validation rmse = 0.041534
Epoch 27
Loss = 1.0319e-02, PNorm = 34.1797, GNorm = 0.3451, lr_0 = 1.0000e-04
Validation rmse = 0.042029
Epoch 28
Loss = 8.0892e-03, PNorm = 34.1810, GNorm = 0.2507, lr_0 = 1.0000e-04
Loss = 2.1963e-02, PNorm = 34.1812, GNorm = 1.4268, lr_0 = 1.0000e-04
Validation rmse = 0.044132
Epoch 29
Validation rmse = 0.042022
Model 0 best validation rmse = 0.041534 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.032971
Ensemble test rmse = 0.032971
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.214095
Epoch 1
Loss = 3.3437e-01, PNorm = 34.0301, GNorm = 8.7927, lr_0 = 1.0000e-03
Validation rmse = 0.194957
Epoch 2
Validation rmse = 0.176116
Epoch 3
Loss = 2.4031e-01, PNorm = 34.0631, GNorm = 10.2145, lr_0 = 8.4834e-04
Validation rmse = 0.153261
Epoch 4
Loss = 1.6651e-01, PNorm = 34.0848, GNorm = 5.7196, lr_0 = 7.2962e-04
Validation rmse = 0.140798
Epoch 5
Validation rmse = 0.133739
Epoch 6
Loss = 1.0759e-01, PNorm = 34.1047, GNorm = 4.2482, lr_0 = 6.2751e-04
Validation rmse = 0.116921
Epoch 7
Validation rmse = 0.092204
Epoch 8
Loss = 8.9567e-02, PNorm = 34.1259, GNorm = 1.5528, lr_0 = 5.3234e-04
Validation rmse = 0.062107
Epoch 9
Loss = 4.3858e-02, PNorm = 34.1439, GNorm = 1.4386, lr_0 = 4.6416e-04
Validation rmse = 0.045314
Epoch 10
Validation rmse = 0.050884
Epoch 11
Loss = 2.0314e-02, PNorm = 34.1582, GNorm = 0.6164, lr_0 = 3.9377e-04
Validation rmse = 0.044044
Epoch 12
Loss = 1.8508e-02, PNorm = 34.1678, GNorm = 0.4706, lr_0 = 3.3866e-04
Validation rmse = 0.060585
Epoch 13
Validation rmse = 0.059640
Epoch 14
Loss = 2.0515e-02, PNorm = 34.1743, GNorm = 0.6786, lr_0 = 2.9126e-04
Validation rmse = 0.053533
Epoch 15
Validation rmse = 0.042249
Epoch 16
Loss = 1.0721e-02, PNorm = 34.1798, GNorm = 0.5766, lr_0 = 2.4709e-04
Validation rmse = 0.049868
Epoch 17
Loss = 1.1008e-02, PNorm = 34.1836, GNorm = 0.9138, lr_0 = 2.1544e-04
Validation rmse = 0.042897
Epoch 18
Validation rmse = 0.042602
Epoch 19
Loss = 7.3262e-03, PNorm = 34.1875, GNorm = 0.5719, lr_0 = 1.8277e-04
Validation rmse = 0.042677
Epoch 20
Loss = 9.4022e-03, PNorm = 34.1904, GNorm = 0.6497, lr_0 = 1.5719e-04
Validation rmse = 0.042861
Epoch 21
Validation rmse = 0.044596
Epoch 22
Loss = 8.6456e-03, PNorm = 34.1924, GNorm = 0.2918, lr_0 = 1.3519e-04
Validation rmse = 0.042138
Epoch 23
Validation rmse = 0.043558
Epoch 24
Loss = 1.1873e-02, PNorm = 34.1945, GNorm = 1.8218, lr_0 = 1.1469e-04
Validation rmse = 0.042405
Epoch 25
Loss = 6.8997e-03, PNorm = 34.1961, GNorm = 0.9470, lr_0 = 1.0000e-04
Validation rmse = 0.040080
Epoch 26
Validation rmse = 0.040555
Epoch 27
Loss = 8.6639e-03, PNorm = 34.1977, GNorm = 1.8055, lr_0 = 1.0000e-04
Validation rmse = 0.039570
Epoch 28
Loss = 6.8863e-03, PNorm = 34.1989, GNorm = 0.4063, lr_0 = 1.0000e-04
Loss = 3.5295e-03, PNorm = 34.1990, GNorm = 0.4058, lr_0 = 1.0000e-04
Validation rmse = 0.039287
Epoch 29
Validation rmse = 0.039296
Model 0 best validation rmse = 0.039287 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.033728
Ensemble test rmse = 0.033728
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.226169
Epoch 1
Loss = 3.5941e-01, PNorm = 34.0296, GNorm = 2.7011, lr_0 = 1.0000e-03
Validation rmse = 0.173729
Epoch 2
Validation rmse = 0.145210
Epoch 3
Loss = 2.1796e-01, PNorm = 34.0626, GNorm = 3.5091, lr_0 = 8.4834e-04
Validation rmse = 0.127163
Epoch 4
Loss = 1.5362e-01, PNorm = 34.0868, GNorm = 3.8505, lr_0 = 7.2962e-04
Validation rmse = 0.100537
Epoch 5
Validation rmse = 0.086372
Epoch 6
Loss = 1.1292e-01, PNorm = 34.1102, GNorm = 1.2028, lr_0 = 6.2751e-04
Validation rmse = 0.070189
Epoch 7
Validation rmse = 0.057800
Epoch 8
Loss = 5.8828e-02, PNorm = 34.1351, GNorm = 0.5699, lr_0 = 5.3234e-04
Validation rmse = 0.065117
Epoch 9
Loss = 3.3841e-02, PNorm = 34.1522, GNorm = 1.4634, lr_0 = 4.6416e-04
Validation rmse = 0.052305
Epoch 10
Validation rmse = 0.064470
Epoch 11
Loss = 3.1129e-02, PNorm = 34.1645, GNorm = 4.0756, lr_0 = 3.9377e-04
Validation rmse = 0.048314
Epoch 12
Loss = 1.5232e-02, PNorm = 34.1713, GNorm = 0.2574, lr_0 = 3.3866e-04
Validation rmse = 0.047663
Epoch 13
Validation rmse = 0.038124
Epoch 14
Loss = 1.6028e-02, PNorm = 34.1765, GNorm = 2.2812, lr_0 = 2.9126e-04
Validation rmse = 0.039716
Epoch 15
Validation rmse = 0.041487
Epoch 16
Loss = 8.5342e-03, PNorm = 34.1800, GNorm = 0.7103, lr_0 = 2.4709e-04
Validation rmse = 0.041612
Epoch 17
Loss = 1.0411e-02, PNorm = 34.1828, GNorm = 0.8029, lr_0 = 2.1544e-04
Validation rmse = 0.038804
Epoch 18
Validation rmse = 0.037499
Epoch 19
Loss = 8.4644e-03, PNorm = 34.1858, GNorm = 0.2579, lr_0 = 1.8277e-04
Validation rmse = 0.039121
Epoch 20
Loss = 7.9774e-03, PNorm = 34.1878, GNorm = 1.2829, lr_0 = 1.5719e-04
Validation rmse = 0.038167
Epoch 21
Validation rmse = 0.036415
Epoch 22
Loss = 6.3970e-03, PNorm = 34.1897, GNorm = 0.8511, lr_0 = 1.3519e-04
Validation rmse = 0.035085
Epoch 23
Validation rmse = 0.035130
Epoch 24
Loss = 5.2683e-03, PNorm = 34.1917, GNorm = 0.2997, lr_0 = 1.1469e-04
Validation rmse = 0.034779
Epoch 25
Loss = 6.3018e-03, PNorm = 34.1931, GNorm = 0.1126, lr_0 = 1.0000e-04
Validation rmse = 0.037012
Epoch 26
Validation rmse = 0.034166
Epoch 27
Loss = 5.1890e-03, PNorm = 34.1946, GNorm = 0.9949, lr_0 = 1.0000e-04
Validation rmse = 0.034984
Epoch 28
Loss = 5.3544e-03, PNorm = 34.1962, GNorm = 0.0834, lr_0 = 1.0000e-04
Loss = 7.7945e-03, PNorm = 34.1964, GNorm = 0.7449, lr_0 = 1.0000e-04
Validation rmse = 0.035277
Epoch 29
Validation rmse = 0.034107
Model 0 best validation rmse = 0.034107 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.040449
Ensemble test rmse = 0.040449
5-fold cross validation
	Seed 0 ==> test rmse = 0.072299
	Seed 1 ==> test rmse = 0.037323
	Seed 2 ==> test rmse = 0.032971
	Seed 3 ==> test rmse = 0.033728
	Seed 4 ==> test rmse = 0.040449
Overall test rmse = 0.043354 +/- 0.014718
Elapsed time = 0:05:41
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573635
Epoch 1
Loss = 4.0732e-01, PNorm = 34.0308, GNorm = 3.8868, lr_0 = 1.0000e-03
Validation r2 = 0.766555
Epoch 2
Validation r2 = 0.838974
Epoch 3
Loss = 2.0783e-01, PNorm = 34.0632, GNorm = 6.0915, lr_0 = 8.4834e-04
Validation r2 = 0.871292
Epoch 4
Loss = 1.6689e-01, PNorm = 34.0856, GNorm = 1.0182, lr_0 = 7.2962e-04
Validation r2 = 0.826266
Epoch 5
Validation r2 = 0.898616
Epoch 6
Loss = 8.6768e-02, PNorm = 34.1060, GNorm = 2.5587, lr_0 = 6.2751e-04
Validation r2 = 0.912944
Epoch 7
Validation r2 = 0.920694
Epoch 8
Loss = 2.7497e-02, PNorm = 34.1289, GNorm = 1.8941, lr_0 = 5.3234e-04
Validation r2 = 0.938624
Epoch 9
Loss = 4.3814e-02, PNorm = 34.1470, GNorm = 0.8257, lr_0 = 4.6416e-04
Validation r2 = 0.944418
Epoch 10
Validation r2 = 0.947835
Epoch 11
Loss = 3.7444e-02, PNorm = 34.1614, GNorm = 3.5345, lr_0 = 3.9377e-04
Validation r2 = 0.952106
Epoch 12
Loss = 2.6658e-02, PNorm = 34.1707, GNorm = 2.4614, lr_0 = 3.3866e-04
Validation r2 = 0.963150
Epoch 13
Validation r2 = 0.962775
Epoch 14
Loss = 1.7791e-02, PNorm = 34.1783, GNorm = 0.9271, lr_0 = 2.9126e-04
Validation r2 = 0.965388
Epoch 15
Validation r2 = 0.969757
Epoch 16
Loss = 1.2962e-02, PNorm = 34.1841, GNorm = 0.2951, lr_0 = 2.4709e-04
Validation r2 = 0.971451
Epoch 17
Loss = 7.3941e-03, PNorm = 34.1879, GNorm = 0.2675, lr_0 = 2.1544e-04
Validation r2 = 0.972829
Epoch 18
Validation r2 = 0.973228
Epoch 19
Loss = 1.9084e-02, PNorm = 34.1911, GNorm = 2.6326, lr_0 = 1.8277e-04
Validation r2 = 0.974482
Epoch 20
Loss = 1.4619e-02, PNorm = 34.1933, GNorm = 2.6697, lr_0 = 1.5719e-04
Validation r2 = 0.973462
Epoch 21
Validation r2 = 0.974309
Epoch 22
Loss = 1.4602e-02, PNorm = 34.1953, GNorm = 0.7436, lr_0 = 1.3519e-04
Validation r2 = 0.977283
Epoch 23
Validation r2 = 0.977629
Epoch 24
Loss = 9.3576e-03, PNorm = 34.1974, GNorm = 0.2251, lr_0 = 1.1469e-04
Validation r2 = 0.977687
Epoch 25
Loss = 1.1266e-02, PNorm = 34.1988, GNorm = 1.8616, lr_0 = 1.0000e-04
Validation r2 = 0.978325
Epoch 26
Validation r2 = 0.978153
Epoch 27
Loss = 9.3101e-03, PNorm = 34.2006, GNorm = 0.2072, lr_0 = 1.0000e-04
Validation r2 = 0.979978
Epoch 28
Loss = 8.3333e-03, PNorm = 34.2021, GNorm = 0.2513, lr_0 = 1.0000e-04
Loss = 4.1585e-03, PNorm = 34.2022, GNorm = 0.5450, lr_0 = 1.0000e-04
Validation r2 = 0.980452
Epoch 29
Validation r2 = 0.980756
Model 0 best validation r2 = 0.980756 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.968928
Ensemble test r2 = 0.968928
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.599386
Epoch 1
Loss = 4.5551e-01, PNorm = 34.0314, GNorm = 16.1830, lr_0 = 1.0000e-03
Validation r2 = 0.790042
Epoch 2
Validation r2 = 0.842139
Epoch 3
Loss = 1.7934e-01, PNorm = 34.0673, GNorm = 4.8361, lr_0 = 8.4834e-04
Validation r2 = 0.871593
Epoch 4
Loss = 1.8540e-01, PNorm = 34.0901, GNorm = 0.8777, lr_0 = 7.2962e-04
Validation r2 = 0.759882
Epoch 5
Validation r2 = 0.888048
Epoch 6
Loss = 1.1832e-01, PNorm = 34.1134, GNorm = 3.1469, lr_0 = 6.2751e-04
Validation r2 = 0.848108
Epoch 7
Validation r2 = 0.894699
Epoch 8
Loss = 8.3449e-02, PNorm = 34.1358, GNorm = 1.7009, lr_0 = 5.3234e-04
Validation r2 = 0.928936
Epoch 9
Loss = 4.9928e-02, PNorm = 34.1537, GNorm = 2.4468, lr_0 = 4.6416e-04
Validation r2 = 0.918774
Epoch 10
Validation r2 = 0.922338
Epoch 11
Loss = 4.4093e-02, PNorm = 34.1688, GNorm = 2.7365, lr_0 = 3.9377e-04
Validation r2 = 0.948223
Epoch 12
Loss = 2.2729e-02, PNorm = 34.1788, GNorm = 0.8159, lr_0 = 3.3866e-04
Validation r2 = 0.955790
Epoch 13
Validation r2 = 0.954074
Epoch 14
Loss = 1.6776e-02, PNorm = 34.1865, GNorm = 0.3069, lr_0 = 2.9126e-04
Validation r2 = 0.957789
Epoch 15
Validation r2 = 0.961307
Epoch 16
Loss = 1.9600e-02, PNorm = 34.1931, GNorm = 0.4563, lr_0 = 2.4709e-04
Validation r2 = 0.970709
Epoch 17
Loss = 1.3360e-02, PNorm = 34.1982, GNorm = 0.6259, lr_0 = 2.1544e-04
Validation r2 = 0.965460
Epoch 18
Validation r2 = 0.971202
Epoch 19
Loss = 8.1413e-03, PNorm = 34.2025, GNorm = 0.4685, lr_0 = 1.8277e-04
Validation r2 = 0.967340
Epoch 20
Loss = 1.0332e-02, PNorm = 34.2050, GNorm = 0.5349, lr_0 = 1.5719e-04
Validation r2 = 0.969009
Epoch 21
Validation r2 = 0.968373
Epoch 22
Loss = 9.1522e-03, PNorm = 34.2081, GNorm = 0.8355, lr_0 = 1.3519e-04
Validation r2 = 0.976376
Epoch 23
Validation r2 = 0.965850
Epoch 24
Loss = 1.0040e-02, PNorm = 34.2103, GNorm = 0.7222, lr_0 = 1.1469e-04
Validation r2 = 0.975096
Epoch 25
Loss = 6.1949e-03, PNorm = 34.2123, GNorm = 1.0822, lr_0 = 1.0000e-04
Validation r2 = 0.976462
Epoch 26
Validation r2 = 0.975596
Epoch 27
Loss = 9.0889e-03, PNorm = 34.2144, GNorm = 0.6331, lr_0 = 1.0000e-04
Validation r2 = 0.977532
Epoch 28
Loss = 7.1361e-03, PNorm = 34.2165, GNorm = 0.4173, lr_0 = 1.0000e-04
Loss = 5.4490e-03, PNorm = 34.2167, GNorm = 1.5344, lr_0 = 1.0000e-04
Validation r2 = 0.978620
Epoch 29
Validation r2 = 0.976272
Model 0 best validation r2 = 0.978620 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991820
Ensemble test r2 = 0.991820
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.691167
Epoch 1
Loss = 2.9264e-01, PNorm = 34.0308, GNorm = 3.2897, lr_0 = 1.0000e-03
Validation r2 = 0.733268
Epoch 2
Validation r2 = 0.760222
Epoch 3
Loss = 1.4465e-01, PNorm = 34.0675, GNorm = 3.5673, lr_0 = 8.4834e-04
Validation r2 = 0.831569
Epoch 4
Loss = 1.1255e-01, PNorm = 34.0934, GNorm = 5.1881, lr_0 = 7.2962e-04
Validation r2 = 0.748199
Epoch 5
Validation r2 = 0.851853
Epoch 6
Loss = 1.0746e-01, PNorm = 34.1106, GNorm = 5.9695, lr_0 = 6.2751e-04
Validation r2 = 0.870190
Epoch 7
Validation r2 = 0.922673
Epoch 8
Loss = 4.6097e-02, PNorm = 34.1237, GNorm = 0.6533, lr_0 = 5.3234e-04
Validation r2 = 0.930392
Epoch 9
Loss = 3.3392e-02, PNorm = 34.1366, GNorm = 1.9340, lr_0 = 4.6416e-04
Validation r2 = 0.944514
Epoch 10
Validation r2 = 0.950440
Epoch 11
Loss = 1.9874e-02, PNorm = 34.1493, GNorm = 0.7251, lr_0 = 3.9377e-04
Validation r2 = 0.955992
Epoch 12
Loss = 1.8196e-02, PNorm = 34.1565, GNorm = 0.6162, lr_0 = 3.3866e-04
Validation r2 = 0.960628
Epoch 13
Validation r2 = 0.962965
Epoch 14
Loss = 1.5607e-02, PNorm = 34.1610, GNorm = 0.7442, lr_0 = 2.9126e-04
Validation r2 = 0.963312
Epoch 15
Validation r2 = 0.971306
Epoch 16
Loss = 9.4105e-03, PNorm = 34.1649, GNorm = 0.1494, lr_0 = 2.4709e-04
Validation r2 = 0.972483
Epoch 17
Loss = 1.2791e-02, PNorm = 34.1674, GNorm = 0.5708, lr_0 = 2.1544e-04
Validation r2 = 0.974099
Epoch 18
Validation r2 = 0.972929
Epoch 19
Loss = 1.4036e-02, PNorm = 34.1705, GNorm = 0.8238, lr_0 = 1.8277e-04
Validation r2 = 0.976565
Epoch 20
Loss = 1.1074e-02, PNorm = 34.1729, GNorm = 0.3476, lr_0 = 1.5719e-04
Validation r2 = 0.975636
Epoch 21
Validation r2 = 0.976595
Epoch 22
Loss = 1.2668e-02, PNorm = 34.1744, GNorm = 2.1022, lr_0 = 1.3519e-04
Validation r2 = 0.977729
Epoch 23
Validation r2 = 0.977451
Epoch 24
Loss = 8.6141e-03, PNorm = 34.1763, GNorm = 0.9590, lr_0 = 1.1469e-04
Validation r2 = 0.979555
Epoch 25
Loss = 1.0335e-02, PNorm = 34.1781, GNorm = 1.0870, lr_0 = 1.0000e-04
Validation r2 = 0.982166
Epoch 26
Validation r2 = 0.982579
Epoch 27
Loss = 1.0322e-02, PNorm = 34.1797, GNorm = 0.3450, lr_0 = 1.0000e-04
Validation r2 = 0.982161
Epoch 28
Loss = 8.0901e-03, PNorm = 34.1810, GNorm = 0.2512, lr_0 = 1.0000e-04
Loss = 2.1964e-02, PNorm = 34.1812, GNorm = 1.4292, lr_0 = 1.0000e-04
Validation r2 = 0.980336
Epoch 29
Validation r2 = 0.982151
Model 0 best validation r2 = 0.982579 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.988009
Ensemble test r2 = 0.988009
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573855
Epoch 1
Loss = 3.3437e-01, PNorm = 34.0301, GNorm = 8.7927, lr_0 = 1.0000e-03
Validation r2 = 0.646637
Epoch 2
Validation r2 = 0.711635
Epoch 3
Loss = 2.4031e-01, PNorm = 34.0631, GNorm = 10.2145, lr_0 = 8.4834e-04
Validation r2 = 0.781623
Epoch 4
Loss = 1.6651e-01, PNorm = 34.0848, GNorm = 5.7196, lr_0 = 7.2962e-04
Validation r2 = 0.815695
Epoch 5
Validation r2 = 0.833713
Epoch 6
Loss = 1.0759e-01, PNorm = 34.1047, GNorm = 4.2482, lr_0 = 6.2751e-04
Validation r2 = 0.872905
Epoch 7
Validation r2 = 0.920961
Epoch 8
Loss = 8.9567e-02, PNorm = 34.1259, GNorm = 1.5528, lr_0 = 5.3234e-04
Validation r2 = 0.964139
Epoch 9
Loss = 4.3858e-02, PNorm = 34.1439, GNorm = 1.4386, lr_0 = 4.6416e-04
Validation r2 = 0.980910
Epoch 10
Validation r2 = 0.975929
Epoch 11
Loss = 2.0314e-02, PNorm = 34.1582, GNorm = 0.6164, lr_0 = 3.9377e-04
Validation r2 = 0.981965
Epoch 12
Loss = 1.8508e-02, PNorm = 34.1678, GNorm = 0.4706, lr_0 = 3.3866e-04
Validation r2 = 0.965875
Epoch 13
Validation r2 = 0.966932
Epoch 14
Loss = 2.0515e-02, PNorm = 34.1743, GNorm = 0.6786, lr_0 = 2.9126e-04
Validation r2 = 0.973357
Epoch 15
Validation r2 = 0.983405
Epoch 16
Loss = 1.0721e-02, PNorm = 34.1798, GNorm = 0.5766, lr_0 = 2.4709e-04
Validation r2 = 0.976880
Epoch 17
Loss = 1.1008e-02, PNorm = 34.1836, GNorm = 0.9138, lr_0 = 2.1544e-04
Validation r2 = 0.982892
Epoch 18
Validation r2 = 0.983126
Epoch 19
Loss = 7.3262e-03, PNorm = 34.1875, GNorm = 0.5719, lr_0 = 1.8277e-04
Validation r2 = 0.983067
Epoch 20
Loss = 9.4022e-03, PNorm = 34.1904, GNorm = 0.6497, lr_0 = 1.5719e-04
Validation r2 = 0.982921
Epoch 21
Validation r2 = 0.981510
Epoch 22
Loss = 8.6456e-03, PNorm = 34.1924, GNorm = 0.2918, lr_0 = 1.3519e-04
Validation r2 = 0.983492
Epoch 23
Validation r2 = 0.982361
Epoch 24
Loss = 1.1873e-02, PNorm = 34.1945, GNorm = 1.8218, lr_0 = 1.1469e-04
Validation r2 = 0.983282
Epoch 25
Loss = 6.8997e-03, PNorm = 34.1961, GNorm = 0.9470, lr_0 = 1.0000e-04
Validation r2 = 0.985065
Epoch 26
Validation r2 = 0.984709
Epoch 27
Loss = 8.6635e-03, PNorm = 34.1977, GNorm = 1.8053, lr_0 = 1.0000e-04
Validation r2 = 0.985443
Epoch 28
Loss = 6.8862e-03, PNorm = 34.1989, GNorm = 0.4062, lr_0 = 1.0000e-04
Loss = 3.5296e-03, PNorm = 34.1990, GNorm = 0.4058, lr_0 = 1.0000e-04
Validation r2 = 0.985650
Epoch 29
Validation r2 = 0.985644
Model 0 best validation r2 = 0.985650 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991553
Ensemble test r2 = 0.991553
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.579424
Epoch 1
Loss = 3.5941e-01, PNorm = 34.0296, GNorm = 2.7011, lr_0 = 1.0000e-03
Validation r2 = 0.751844
Epoch 2
Validation r2 = 0.826631
Epoch 3
Loss = 2.1796e-01, PNorm = 34.0626, GNorm = 3.5091, lr_0 = 8.4834e-04
Validation r2 = 0.867047
Epoch 4
Loss = 1.5362e-01, PNorm = 34.0868, GNorm = 3.8505, lr_0 = 7.2962e-04
Validation r2 = 0.916895
Epoch 5
Validation r2 = 0.938662
Epoch 6
Loss = 1.1292e-01, PNorm = 34.1102, GNorm = 1.2028, lr_0 = 6.2751e-04
Validation r2 = 0.959495
Epoch 7
Validation r2 = 0.972531
Epoch 8
Loss = 5.8828e-02, PNorm = 34.1351, GNorm = 0.5699, lr_0 = 5.3234e-04
Validation r2 = 0.965137
Epoch 9
Loss = 3.3841e-02, PNorm = 34.1522, GNorm = 1.4634, lr_0 = 4.6416e-04
Validation r2 = 0.977506
Epoch 10
Validation r2 = 0.965826
Epoch 11
Loss = 3.1129e-02, PNorm = 34.1645, GNorm = 4.0756, lr_0 = 3.9377e-04
Validation r2 = 0.980807
Epoch 12
Loss = 1.5232e-02, PNorm = 34.1713, GNorm = 0.2574, lr_0 = 3.3866e-04
Validation r2 = 0.981321
Epoch 13
Validation r2 = 0.988050
Epoch 14
Loss = 1.6028e-02, PNorm = 34.1765, GNorm = 2.2812, lr_0 = 2.9126e-04
Validation r2 = 0.987031
Epoch 15
Validation r2 = 0.985849
Epoch 16
Loss = 8.5342e-03, PNorm = 34.1800, GNorm = 0.7103, lr_0 = 2.4709e-04
Validation r2 = 0.985763
Epoch 17
Loss = 1.0411e-02, PNorm = 34.1828, GNorm = 0.8029, lr_0 = 2.1544e-04
Validation r2 = 0.987620
Epoch 18
Validation r2 = 0.988438
Epoch 19
Loss = 8.4644e-03, PNorm = 34.1858, GNorm = 0.2579, lr_0 = 1.8277e-04
Validation r2 = 0.987417
Epoch 20
Loss = 7.9774e-03, PNorm = 34.1878, GNorm = 1.2829, lr_0 = 1.5719e-04
Validation r2 = 0.988023
Epoch 21
Validation r2 = 0.989097
Epoch 22
Loss = 6.3970e-03, PNorm = 34.1897, GNorm = 0.8511, lr_0 = 1.3519e-04
Validation r2 = 0.989879
Epoch 23
Validation r2 = 0.989853
Epoch 24
Loss = 5.2683e-03, PNorm = 34.1917, GNorm = 0.2997, lr_0 = 1.1469e-04
Validation r2 = 0.990055
Epoch 25
Loss = 6.3018e-03, PNorm = 34.1931, GNorm = 0.1126, lr_0 = 1.0000e-04
Validation r2 = 0.988737
Epoch 26
Validation r2 = 0.990402
Epoch 27
Loss = 5.1890e-03, PNorm = 34.1946, GNorm = 0.9949, lr_0 = 1.0000e-04
Validation r2 = 0.989937
Epoch 28
Loss = 5.3543e-03, PNorm = 34.1962, GNorm = 0.0834, lr_0 = 1.0000e-04
Loss = 7.7945e-03, PNorm = 34.1964, GNorm = 0.7449, lr_0 = 1.0000e-04
Validation r2 = 0.989768
Epoch 29
Validation r2 = 0.990435
Model 0 best validation r2 = 0.990435 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.986383
Ensemble test r2 = 0.986383
5-fold cross validation
	Seed 0 ==> test r2 = 0.968928
	Seed 1 ==> test r2 = 0.991820
	Seed 2 ==> test r2 = 0.988009
	Seed 3 ==> test r2 = 0.991553
	Seed 4 ==> test r2 = 0.986383
Overall test r2 = 0.985338 +/- 0.008463
Elapsed time = 0:05:44
Command line
python ./chemprop/train.py --data_path ./csv_files/Polymers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/Polymers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.447028
Epoch 1
Loss = 4.9526e-01, PNorm = 34.0300, GNorm = 7.0589, lr_0 = 1.0000e-03
Validation r2 = 0.812206
Epoch 2
Validation r2 = 0.793245
Epoch 3
Loss = 2.0403e-01, PNorm = 34.0595, GNorm = 1.7330, lr_0 = 8.4834e-04
Validation r2 = 0.807138
Epoch 4
Loss = 1.6469e-01, PNorm = 34.0820, GNorm = 1.5884, lr_0 = 7.2962e-04
Validation r2 = 0.863449
Epoch 5
Validation r2 = 0.895466
Epoch 6
Loss = 8.9151e-02, PNorm = 34.1027, GNorm = 2.3176, lr_0 = 6.2751e-04
Validation r2 = 0.889677
Epoch 7
Validation r2 = 0.920205
Epoch 8
Loss = 2.5924e-02, PNorm = 34.1233, GNorm = 1.0978, lr_0 = 5.3234e-04
Validation r2 = 0.927166
Epoch 9
Loss = 5.3407e-02, PNorm = 34.1398, GNorm = 1.5696, lr_0 = 4.6416e-04
Validation r2 = 0.925792
Epoch 10
Validation r2 = 0.931988
Epoch 11
Loss = 4.6521e-02, PNorm = 34.1525, GNorm = 3.4909, lr_0 = 3.9377e-04
Validation r2 = 0.939884
Epoch 12
Loss = 3.2715e-02, PNorm = 34.1602, GNorm = 2.4543, lr_0 = 3.3866e-04
Validation r2 = 0.955951
Epoch 13
Validation r2 = 0.954705
Epoch 14
Loss = 2.4313e-02, PNorm = 34.1668, GNorm = 1.8528, lr_0 = 2.9126e-04
Validation r2 = 0.955342
Epoch 15
Validation r2 = 0.961059
Epoch 16
Loss = 2.1907e-02, PNorm = 34.1719, GNorm = 0.4036, lr_0 = 2.4709e-04
Validation r2 = 0.962922
Epoch 17
Loss = 1.0971e-02, PNorm = 34.1753, GNorm = 0.2882, lr_0 = 2.1544e-04
Validation r2 = 0.964236
Epoch 18
Validation r2 = 0.965863
Epoch 19
Loss = 2.3384e-02, PNorm = 34.1784, GNorm = 2.7517, lr_0 = 1.8277e-04
Validation r2 = 0.966450
Epoch 20
Loss = 2.0948e-02, PNorm = 34.1806, GNorm = 3.0678, lr_0 = 1.5719e-04
Validation r2 = 0.966360
Epoch 21
Validation r2 = 0.967252
Epoch 22
Loss = 1.7608e-02, PNorm = 34.1823, GNorm = 0.8855, lr_0 = 1.3519e-04
Validation r2 = 0.970074
Epoch 23
Validation r2 = 0.970550
Epoch 24
Loss = 1.3311e-02, PNorm = 34.1844, GNorm = 0.6776, lr_0 = 1.1469e-04
Validation r2 = 0.971296
Epoch 25
Loss = 1.6294e-02, PNorm = 34.1857, GNorm = 2.8012, lr_0 = 1.0000e-04
Validation r2 = 0.971229
Epoch 26
Validation r2 = 0.970695
Epoch 27
Loss = 1.4100e-02, PNorm = 34.1875, GNorm = 0.2968, lr_0 = 1.0000e-04
Validation r2 = 0.973762
Epoch 28
Loss = 1.2465e-02, PNorm = 34.1890, GNorm = 0.8246, lr_0 = 1.0000e-04
Loss = 6.0067e-03, PNorm = 34.1891, GNorm = 0.6792, lr_0 = 1.0000e-04
Validation r2 = 0.974301
Epoch 29
Validation r2 = 0.974528
Model 0 best validation r2 = 0.974528 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.976633
Ensemble test r2 = 0.976633
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.581038
Epoch 1
Loss = 4.5332e-01, PNorm = 34.0316, GNorm = 16.0271, lr_0 = 1.0000e-03
Validation r2 = 0.766657
Epoch 2
Validation r2 = 0.821631
Epoch 3
Loss = 1.9454e-01, PNorm = 34.0688, GNorm = 6.1657, lr_0 = 8.4834e-04
Validation r2 = 0.853557
Epoch 4
Loss = 1.9229e-01, PNorm = 34.0917, GNorm = 1.6721, lr_0 = 7.2962e-04
Validation r2 = 0.737789
Epoch 5
Validation r2 = 0.888454
Epoch 6
Loss = 1.3047e-01, PNorm = 34.1137, GNorm = 3.6657, lr_0 = 6.2751e-04
Validation r2 = 0.824365
Epoch 7
Validation r2 = 0.882500
Epoch 8
Loss = 8.8848e-02, PNorm = 34.1360, GNorm = 1.8673, lr_0 = 5.3234e-04
Validation r2 = 0.920520
Epoch 9
Loss = 6.0062e-02, PNorm = 34.1541, GNorm = 3.3259, lr_0 = 4.6416e-04
Validation r2 = 0.891123
Epoch 10
Validation r2 = 0.910054
Epoch 11
Loss = 5.2652e-02, PNorm = 34.1694, GNorm = 2.8905, lr_0 = 3.9377e-04
Validation r2 = 0.936108
Epoch 12
Loss = 2.8683e-02, PNorm = 34.1794, GNorm = 0.3070, lr_0 = 3.3866e-04
Validation r2 = 0.936328
Epoch 13
Validation r2 = 0.935065
Epoch 14
Loss = 2.1892e-02, PNorm = 34.1874, GNorm = 0.4465, lr_0 = 2.9126e-04
Validation r2 = 0.933301
Epoch 15
Validation r2 = 0.947179
Epoch 16
Loss = 2.5294e-02, PNorm = 34.1941, GNorm = 0.3958, lr_0 = 2.4709e-04
Validation r2 = 0.954827
Epoch 17
Loss = 1.7711e-02, PNorm = 34.1994, GNorm = 0.3137, lr_0 = 2.1544e-04
Validation r2 = 0.948779
Epoch 18
Validation r2 = 0.951157
Epoch 19
Loss = 1.5799e-02, PNorm = 34.2042, GNorm = 0.2518, lr_0 = 1.8277e-04
Validation r2 = 0.947824
Epoch 20
Loss = 1.3289e-02, PNorm = 34.2071, GNorm = 0.5221, lr_0 = 1.5719e-04
Validation r2 = 0.953772
Epoch 21
Validation r2 = 0.950410
Epoch 22
Loss = 1.3136e-02, PNorm = 34.2103, GNorm = 1.0897, lr_0 = 1.3519e-04
Validation r2 = 0.960463
Epoch 23
Validation r2 = 0.950336
Epoch 24
Loss = 1.5853e-02, PNorm = 34.2126, GNorm = 0.6325, lr_0 = 1.1469e-04
Validation r2 = 0.960664
Epoch 25
Loss = 7.5425e-03, PNorm = 34.2147, GNorm = 0.7383, lr_0 = 1.0000e-04
Validation r2 = 0.960120
Epoch 26
Validation r2 = 0.961286
Epoch 27
Loss = 1.0914e-02, PNorm = 34.2170, GNorm = 0.5233, lr_0 = 1.0000e-04
Validation r2 = 0.963635
Epoch 28
Loss = 9.3717e-03, PNorm = 34.2191, GNorm = 0.4004, lr_0 = 1.0000e-04
Loss = 9.4530e-03, PNorm = 34.2193, GNorm = 1.9920, lr_0 = 1.0000e-04
Validation r2 = 0.963280
Epoch 29
Validation r2 = 0.960865
Model 0 best validation r2 = 0.963635 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991776
Ensemble test r2 = 0.991776
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.702344
Epoch 1
Loss = 3.0236e-01, PNorm = 34.0313, GNorm = 2.3965, lr_0 = 1.0000e-03
Validation r2 = 0.789698
Epoch 2
Validation r2 = 0.736299
Epoch 3
Loss = 1.4527e-01, PNorm = 34.0692, GNorm = 5.5099, lr_0 = 8.4834e-04
Validation r2 = 0.848671
Epoch 4
Loss = 1.1101e-01, PNorm = 34.0945, GNorm = 0.5000, lr_0 = 7.2962e-04
Validation r2 = 0.825948
Epoch 5
Validation r2 = 0.811633
Epoch 6
Loss = 8.1861e-02, PNorm = 34.1146, GNorm = 1.0898, lr_0 = 6.2751e-04
Validation r2 = 0.907676
Epoch 7
Validation r2 = 0.915979
Epoch 8
Loss = 5.8026e-02, PNorm = 34.1296, GNorm = 3.5417, lr_0 = 5.3234e-04
Validation r2 = 0.883083
Epoch 9
Loss = 5.2786e-02, PNorm = 34.1424, GNorm = 4.0110, lr_0 = 4.6416e-04
Validation r2 = 0.924536
Epoch 10
Validation r2 = 0.923324
Epoch 11
Loss = 3.3311e-02, PNorm = 34.1535, GNorm = 3.2715, lr_0 = 3.9377e-04
Validation r2 = 0.939781
Epoch 12
Loss = 2.1852e-02, PNorm = 34.1612, GNorm = 0.9406, lr_0 = 3.3866e-04
Validation r2 = 0.946119
Epoch 13
Validation r2 = 0.951000
Epoch 14
Loss = 1.4127e-02, PNorm = 34.1663, GNorm = 0.3367, lr_0 = 2.9126e-04
Validation r2 = 0.952804
Epoch 15
Validation r2 = 0.959687
Epoch 16
Loss = 1.0074e-02, PNorm = 34.1708, GNorm = 0.5267, lr_0 = 2.4709e-04
Validation r2 = 0.961615
Epoch 17
Loss = 1.6499e-02, PNorm = 34.1738, GNorm = 0.4237, lr_0 = 2.1544e-04
Validation r2 = 0.964132
Epoch 18
Validation r2 = 0.964513
Epoch 19
Loss = 1.5514e-02, PNorm = 34.1774, GNorm = 0.9722, lr_0 = 1.8277e-04
Validation r2 = 0.967138
Epoch 20
Loss = 1.2818e-02, PNorm = 34.1802, GNorm = 0.3767, lr_0 = 1.5719e-04
Validation r2 = 0.967388
Epoch 21
Validation r2 = 0.964309
Epoch 22
Loss = 1.5228e-02, PNorm = 34.1822, GNorm = 1.1360, lr_0 = 1.3519e-04
Validation r2 = 0.970610
Epoch 23
Validation r2 = 0.969460
Epoch 24
Loss = 9.3043e-03, PNorm = 34.1846, GNorm = 0.9467, lr_0 = 1.1469e-04
Validation r2 = 0.968740
Epoch 25
Loss = 1.2417e-02, PNorm = 34.1866, GNorm = 1.0174, lr_0 = 1.0000e-04
Validation r2 = 0.975313
Epoch 26
Validation r2 = 0.975591
Epoch 27
Loss = 1.3395e-02, PNorm = 34.1884, GNorm = 0.3715, lr_0 = 1.0000e-04
Validation r2 = 0.976075
Epoch 28
Loss = 8.9578e-03, PNorm = 34.1899, GNorm = 0.5340, lr_0 = 1.0000e-04
Loss = 3.1685e-02, PNorm = 34.1900, GNorm = 1.8294, lr_0 = 1.0000e-04
Validation r2 = 0.975674
Epoch 29
Validation r2 = 0.974822
Model 0 best validation r2 = 0.976075 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.984134
Ensemble test r2 = 0.984134
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573233
Epoch 1
Loss = 3.5523e-01, PNorm = 34.0305, GNorm = 10.0984, lr_0 = 1.0000e-03
Validation r2 = 0.654405
Epoch 2
Validation r2 = 0.677615
Epoch 3
Loss = 2.5790e-01, PNorm = 34.0659, GNorm = 10.0133, lr_0 = 8.4834e-04
Validation r2 = 0.759219
Epoch 4
Loss = 1.6410e-01, PNorm = 34.0887, GNorm = 4.5556, lr_0 = 7.2962e-04
Validation r2 = 0.831893
Epoch 5
Validation r2 = 0.863899
Epoch 6
Loss = 1.1017e-01, PNorm = 34.1113, GNorm = 5.4620, lr_0 = 6.2751e-04
Validation r2 = 0.902132
Epoch 7
Validation r2 = 0.925615
Epoch 8
Loss = 9.0707e-02, PNorm = 34.1316, GNorm = 0.8933, lr_0 = 5.3234e-04
Validation r2 = 0.951288
Epoch 9
Loss = 6.3609e-02, PNorm = 34.1482, GNorm = 0.8295, lr_0 = 4.6416e-04
Validation r2 = 0.968890
Epoch 10
Validation r2 = 0.958770
Epoch 11
Loss = 3.1332e-02, PNorm = 34.1645, GNorm = 0.6223, lr_0 = 3.9377e-04
Validation r2 = 0.971673
Epoch 12
Loss = 2.5398e-02, PNorm = 34.1747, GNorm = 0.2998, lr_0 = 3.3866e-04
Validation r2 = 0.944586
Epoch 13
Validation r2 = 0.959771
Epoch 14
Loss = 2.9615e-02, PNorm = 34.1818, GNorm = 2.7138, lr_0 = 2.9126e-04
Validation r2 = 0.971146
Epoch 15
Validation r2 = 0.964720
Epoch 16
Loss = 2.6452e-02, PNorm = 34.1878, GNorm = 2.9117, lr_0 = 2.4709e-04
Validation r2 = 0.975269
Epoch 17
Loss = 1.9413e-02, PNorm = 34.1929, GNorm = 1.6741, lr_0 = 2.1544e-04
Validation r2 = 0.965146
Epoch 18
Validation r2 = 0.979217
Epoch 19
Loss = 9.6701e-03, PNorm = 34.1981, GNorm = 1.0043, lr_0 = 1.8277e-04
Validation r2 = 0.976810
Epoch 20
Loss = 1.3522e-02, PNorm = 34.2020, GNorm = 1.3316, lr_0 = 1.5719e-04
Validation r2 = 0.978834
Epoch 21
Validation r2 = 0.979024
Epoch 22
Loss = 1.0122e-02, PNorm = 34.2045, GNorm = 0.6082, lr_0 = 1.3519e-04
Validation r2 = 0.979179
Epoch 23
Validation r2 = 0.979003
Epoch 24
Loss = 8.7573e-03, PNorm = 34.2072, GNorm = 0.8702, lr_0 = 1.1469e-04
Validation r2 = 0.979638
Epoch 25
Loss = 7.2988e-03, PNorm = 34.2093, GNorm = 0.2387, lr_0 = 1.0000e-04
Validation r2 = 0.978238
Epoch 26
Validation r2 = 0.979741
Epoch 27
Loss = 9.3176e-03, PNorm = 34.2114, GNorm = 0.5069, lr_0 = 1.0000e-04
Validation r2 = 0.981146
Epoch 28
Loss = 7.8374e-03, PNorm = 34.2128, GNorm = 0.2641, lr_0 = 1.0000e-04
Loss = 5.2862e-03, PNorm = 34.2130, GNorm = 0.5368, lr_0 = 1.0000e-04
Validation r2 = 0.981511
Epoch 29
Validation r2 = 0.981008
Model 0 best validation r2 = 0.981511 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.989179
Ensemble test r2 = 0.989179
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.488557
Epoch 1
Loss = 4.2840e-01, PNorm = 34.0296, GNorm = 5.7881, lr_0 = 1.0000e-03
Validation r2 = 0.749998
Epoch 2
Validation r2 = 0.842924
Epoch 3
Loss = 1.7500e-01, PNorm = 34.0614, GNorm = 1.6449, lr_0 = 8.4834e-04
Validation r2 = 0.869235
Epoch 4
Loss = 1.5873e-01, PNorm = 34.0847, GNorm = 2.6800, lr_0 = 7.2962e-04
Validation r2 = 0.852303
Epoch 5
Validation r2 = 0.916787
Epoch 6
Loss = 1.1921e-01, PNorm = 34.1090, GNorm = 0.4894, lr_0 = 6.2751e-04
Validation r2 = 0.932363
Epoch 7
Validation r2 = 0.952755
Epoch 8
Loss = 7.9127e-02, PNorm = 34.1354, GNorm = 3.9871, lr_0 = 5.3234e-04
Validation r2 = 0.962506
Epoch 9
Loss = 3.2620e-02, PNorm = 34.1521, GNorm = 0.1644, lr_0 = 4.6416e-04
Validation r2 = 0.973356
Epoch 10
Validation r2 = 0.949643
Epoch 11
Loss = 3.8622e-02, PNorm = 34.1649, GNorm = 2.0096, lr_0 = 3.9377e-04
Validation r2 = 0.978248
Epoch 12
Loss = 1.8160e-02, PNorm = 34.1722, GNorm = 0.2391, lr_0 = 3.3866e-04
Validation r2 = 0.980044
Epoch 13
Validation r2 = 0.980598
Epoch 14
Loss = 1.8198e-02, PNorm = 34.1777, GNorm = 1.0909, lr_0 = 2.9126e-04
Validation r2 = 0.980609
Epoch 15
Validation r2 = 0.981440
Epoch 16
Loss = 1.1563e-02, PNorm = 34.1813, GNorm = 0.7019, lr_0 = 2.4709e-04
Validation r2 = 0.981594
Epoch 17
Loss = 1.1962e-02, PNorm = 34.1843, GNorm = 0.2890, lr_0 = 2.1544e-04
Validation r2 = 0.982049
Epoch 18
Validation r2 = 0.981803
Epoch 19
Loss = 9.8921e-03, PNorm = 34.1875, GNorm = 0.2565, lr_0 = 1.8277e-04
Validation r2 = 0.980580
Epoch 20
Loss = 1.0863e-02, PNorm = 34.1898, GNorm = 1.9858, lr_0 = 1.5719e-04
Validation r2 = 0.982095
Epoch 21
Validation r2 = 0.982802
Epoch 22
Loss = 8.2802e-03, PNorm = 34.1916, GNorm = 0.8136, lr_0 = 1.3519e-04
Validation r2 = 0.983967
Epoch 23
Validation r2 = 0.984315
Epoch 24
Loss = 8.1349e-03, PNorm = 34.1936, GNorm = 0.5505, lr_0 = 1.1469e-04
Validation r2 = 0.984374
Epoch 25
Loss = 8.4005e-03, PNorm = 34.1949, GNorm = 0.3204, lr_0 = 1.0000e-04
Validation r2 = 0.984081
Epoch 26
Validation r2 = 0.984875
Epoch 27
Loss = 6.9274e-03, PNorm = 34.1962, GNorm = 0.4672, lr_0 = 1.0000e-04
Validation r2 = 0.984535
Epoch 28
Loss = 7.0188e-03, PNorm = 34.1979, GNorm = 0.1219, lr_0 = 1.0000e-04
Loss = 1.0949e-02, PNorm = 34.1981, GNorm = 0.5847, lr_0 = 1.0000e-04
Validation r2 = 0.983785
Epoch 29
Validation r2 = 0.985148
Model 0 best validation r2 = 0.985148 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.981364
Ensemble test r2 = 0.981364
5-fold cross validation
	Seed 0 ==> test r2 = 0.976633
	Seed 1 ==> test r2 = 0.991776
	Seed 2 ==> test r2 = 0.984134
	Seed 3 ==> test r2 = 0.989179
	Seed 4 ==> test r2 = 0.981364
Overall test r2 = 0.984617 +/- 0.005415
Elapsed time = 0:02:13
Command line
python ./chemprop/train.py --data_path ./csv_files/Polymers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric rmse
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/Polymers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.280914
Epoch 1
Loss = 4.9526e-01, PNorm = 34.0300, GNorm = 7.0589, lr_0 = 1.0000e-03
Validation rmse = 0.163705
Epoch 2
Validation rmse = 0.171771
Epoch 3
Loss = 2.0403e-01, PNorm = 34.0595, GNorm = 1.7330, lr_0 = 8.4834e-04
Validation rmse = 0.165900
Epoch 4
Loss = 1.6469e-01, PNorm = 34.0820, GNorm = 1.5884, lr_0 = 7.2962e-04
Validation rmse = 0.139595
Epoch 5
Validation rmse = 0.122138
Epoch 6
Loss = 8.9151e-02, PNorm = 34.1027, GNorm = 2.3176, lr_0 = 6.2751e-04
Validation rmse = 0.125474
Epoch 7
Validation rmse = 0.106711
Epoch 8
Loss = 2.5924e-02, PNorm = 34.1233, GNorm = 1.0978, lr_0 = 5.3234e-04
Validation rmse = 0.101950
Epoch 9
Loss = 5.3407e-02, PNorm = 34.1398, GNorm = 1.5696, lr_0 = 4.6416e-04
Validation rmse = 0.102908
Epoch 10
Validation rmse = 0.098518
Epoch 11
Loss = 4.6521e-02, PNorm = 34.1525, GNorm = 3.4909, lr_0 = 3.9377e-04
Validation rmse = 0.092623
Epoch 12
Loss = 3.2715e-02, PNorm = 34.1602, GNorm = 2.4543, lr_0 = 3.3866e-04
Validation rmse = 0.079285
Epoch 13
Validation rmse = 0.080398
Epoch 14
Loss = 2.4313e-02, PNorm = 34.1668, GNorm = 1.8528, lr_0 = 2.9126e-04
Validation rmse = 0.079831
Epoch 15
Validation rmse = 0.074546
Epoch 16
Loss = 2.1907e-02, PNorm = 34.1719, GNorm = 0.4036, lr_0 = 2.4709e-04
Validation rmse = 0.072741
Epoch 17
Loss = 1.0971e-02, PNorm = 34.1753, GNorm = 0.2882, lr_0 = 2.1544e-04
Validation rmse = 0.071440
Epoch 18
Validation rmse = 0.069796
Epoch 19
Loss = 2.3384e-02, PNorm = 34.1784, GNorm = 2.7517, lr_0 = 1.8277e-04
Validation rmse = 0.069194
Epoch 20
Loss = 2.0948e-02, PNorm = 34.1806, GNorm = 3.0678, lr_0 = 1.5719e-04
Validation rmse = 0.069286
Epoch 21
Validation rmse = 0.068362
Epoch 22
Loss = 1.7608e-02, PNorm = 34.1823, GNorm = 0.8855, lr_0 = 1.3519e-04
Validation rmse = 0.065350
Epoch 23
Validation rmse = 0.064829
Epoch 24
Loss = 1.3311e-02, PNorm = 34.1844, GNorm = 0.6776, lr_0 = 1.1469e-04
Validation rmse = 0.064001
Epoch 25
Loss = 1.6294e-02, PNorm = 34.1857, GNorm = 2.8012, lr_0 = 1.0000e-04
Validation rmse = 0.064076
Epoch 26
Validation rmse = 0.064668
Epoch 27
Loss = 1.4100e-02, PNorm = 34.1875, GNorm = 0.2968, lr_0 = 1.0000e-04
Validation rmse = 0.061190
Epoch 28
Loss = 1.2465e-02, PNorm = 34.1890, GNorm = 0.8246, lr_0 = 1.0000e-04
Loss = 6.0067e-03, PNorm = 34.1891, GNorm = 0.6792, lr_0 = 1.0000e-04
Validation rmse = 0.060559
Epoch 29
Validation rmse = 0.060291
Model 0 best validation rmse = 0.060291 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.062697
Ensemble test rmse = 0.062697
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.170902
Epoch 1
Loss = 4.5332e-01, PNorm = 34.0316, GNorm = 16.0271, lr_0 = 1.0000e-03
Validation rmse = 0.127543
Epoch 2
Validation rmse = 0.111511
Epoch 3
Loss = 1.9454e-01, PNorm = 34.0688, GNorm = 6.1657, lr_0 = 8.4834e-04
Validation rmse = 0.101040
Epoch 4
Loss = 1.9229e-01, PNorm = 34.0917, GNorm = 1.6721, lr_0 = 7.2962e-04
Validation rmse = 0.135202
Epoch 5
Validation rmse = 0.088183
Epoch 6
Loss = 1.3047e-01, PNorm = 34.1137, GNorm = 3.6657, lr_0 = 6.2751e-04
Validation rmse = 0.110653
Epoch 7
Validation rmse = 0.090506
Epoch 8
Loss = 8.8848e-02, PNorm = 34.1360, GNorm = 1.8673, lr_0 = 5.3234e-04
Validation rmse = 0.074437
Epoch 9
Loss = 6.0062e-02, PNorm = 34.1541, GNorm = 3.3259, lr_0 = 4.6416e-04
Validation rmse = 0.087122
Epoch 10
Validation rmse = 0.079186
Epoch 11
Loss = 5.2652e-02, PNorm = 34.1694, GNorm = 2.8905, lr_0 = 3.9377e-04
Validation rmse = 0.066739
Epoch 12
Loss = 2.8683e-02, PNorm = 34.1794, GNorm = 0.3070, lr_0 = 3.3866e-04
Validation rmse = 0.066624
Epoch 13
Validation rmse = 0.067282
Epoch 14
Loss = 2.1892e-02, PNorm = 34.1874, GNorm = 0.4465, lr_0 = 2.9126e-04
Validation rmse = 0.068190
Epoch 15
Validation rmse = 0.060682
Epoch 16
Loss = 2.5294e-02, PNorm = 34.1941, GNorm = 0.3958, lr_0 = 2.4709e-04
Validation rmse = 0.056118
Epoch 17
Loss = 1.7711e-02, PNorm = 34.1994, GNorm = 0.3137, lr_0 = 2.1544e-04
Validation rmse = 0.059757
Epoch 18
Validation rmse = 0.058353
Epoch 19
Loss = 1.5799e-02, PNorm = 34.2042, GNorm = 0.2518, lr_0 = 1.8277e-04
Validation rmse = 0.060311
Epoch 20
Loss = 1.3289e-02, PNorm = 34.2071, GNorm = 0.5221, lr_0 = 1.5719e-04
Validation rmse = 0.056769
Epoch 21
Validation rmse = 0.058797
Epoch 22
Loss = 1.3136e-02, PNorm = 34.2103, GNorm = 1.0897, lr_0 = 1.3519e-04
Validation rmse = 0.052500
Epoch 23
Validation rmse = 0.058841
Epoch 24
Loss = 1.5853e-02, PNorm = 34.2126, GNorm = 0.6325, lr_0 = 1.1469e-04
Validation rmse = 0.052366
Epoch 25
Loss = 7.5425e-03, PNorm = 34.2147, GNorm = 0.7383, lr_0 = 1.0000e-04
Validation rmse = 0.052728
Epoch 26
Validation rmse = 0.051951
Epoch 27
Loss = 1.0914e-02, PNorm = 34.2170, GNorm = 0.5236, lr_0 = 1.0000e-04
Validation rmse = 0.050356
Epoch 28
Loss = 9.3719e-03, PNorm = 34.2191, GNorm = 0.4011, lr_0 = 1.0000e-04
Loss = 9.4477e-03, PNorm = 34.2193, GNorm = 1.9912, lr_0 = 1.0000e-04
Validation rmse = 0.050599
Epoch 29
Validation rmse = 0.052235
Model 0 best validation rmse = 0.050356 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.037610
Ensemble test rmse = 0.037610
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.171522
Epoch 1
Loss = 3.0236e-01, PNorm = 34.0313, GNorm = 2.3965, lr_0 = 1.0000e-03
Validation rmse = 0.144173
Epoch 2
Validation rmse = 0.161443
Epoch 3
Loss = 1.4527e-01, PNorm = 34.0692, GNorm = 5.5099, lr_0 = 8.4834e-04
Validation rmse = 0.122299
Epoch 4
Loss = 1.1101e-01, PNorm = 34.0945, GNorm = 0.5000, lr_0 = 7.2962e-04
Validation rmse = 0.131160
Epoch 5
Validation rmse = 0.136448
Epoch 6
Loss = 8.1861e-02, PNorm = 34.1146, GNorm = 1.0898, lr_0 = 6.2751e-04
Validation rmse = 0.095526
Epoch 7
Validation rmse = 0.091129
Epoch 8
Loss = 5.8026e-02, PNorm = 34.1296, GNorm = 3.5417, lr_0 = 5.3234e-04
Validation rmse = 0.107498
Epoch 9
Loss = 5.2786e-02, PNorm = 34.1424, GNorm = 4.0110, lr_0 = 4.6416e-04
Validation rmse = 0.086364
Epoch 10
Validation rmse = 0.087055
Epoch 11
Loss = 3.3311e-02, PNorm = 34.1535, GNorm = 3.2715, lr_0 = 3.9377e-04
Validation rmse = 0.077149
Epoch 12
Loss = 2.1852e-02, PNorm = 34.1612, GNorm = 0.9406, lr_0 = 3.3866e-04
Validation rmse = 0.072976
Epoch 13
Validation rmse = 0.069592
Epoch 14
Loss = 1.4127e-02, PNorm = 34.1663, GNorm = 0.3367, lr_0 = 2.9126e-04
Validation rmse = 0.068299
Epoch 15
Validation rmse = 0.063123
Epoch 16
Loss = 1.0074e-02, PNorm = 34.1708, GNorm = 0.5267, lr_0 = 2.4709e-04
Validation rmse = 0.061594
Epoch 17
Loss = 1.6499e-02, PNorm = 34.1738, GNorm = 0.4237, lr_0 = 2.1544e-04
Validation rmse = 0.059541
Epoch 18
Validation rmse = 0.059224
Epoch 19
Loss = 1.5514e-02, PNorm = 34.1774, GNorm = 0.9722, lr_0 = 1.8277e-04
Validation rmse = 0.056992
Epoch 20
Loss = 1.2818e-02, PNorm = 34.1802, GNorm = 0.3767, lr_0 = 1.5719e-04
Validation rmse = 0.056774
Epoch 21
Validation rmse = 0.059394
Epoch 22
Loss = 1.5228e-02, PNorm = 34.1822, GNorm = 1.1360, lr_0 = 1.3519e-04
Validation rmse = 0.053897
Epoch 23
Validation rmse = 0.054941
Epoch 24
Loss = 9.3043e-03, PNorm = 34.1846, GNorm = 0.9467, lr_0 = 1.1469e-04
Validation rmse = 0.055585
Epoch 25
Loss = 1.2417e-02, PNorm = 34.1866, GNorm = 1.0174, lr_0 = 1.0000e-04
Validation rmse = 0.049397
Epoch 26
Validation rmse = 0.049117
Epoch 27
Loss = 1.3395e-02, PNorm = 34.1884, GNorm = 0.3715, lr_0 = 1.0000e-04
Validation rmse = 0.048628
Epoch 28
Loss = 8.9578e-03, PNorm = 34.1899, GNorm = 0.5340, lr_0 = 1.0000e-04
Loss = 3.1685e-02, PNorm = 34.1900, GNorm = 1.8294, lr_0 = 1.0000e-04
Validation rmse = 0.049034
Epoch 29
Validation rmse = 0.049885
Model 0 best validation rmse = 0.048628 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.037951
Ensemble test rmse = 0.037951
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.214252
Epoch 1
Loss = 3.5523e-01, PNorm = 34.0305, GNorm = 10.0984, lr_0 = 1.0000e-03
Validation rmse = 0.192802
Epoch 2
Validation rmse = 0.186216
Epoch 3
Loss = 2.5790e-01, PNorm = 34.0659, GNorm = 10.0133, lr_0 = 8.4834e-04
Validation rmse = 0.160931
Epoch 4
Loss = 1.6410e-01, PNorm = 34.0887, GNorm = 4.5556, lr_0 = 7.2962e-04
Validation rmse = 0.134469
Epoch 5
Validation rmse = 0.120993
Epoch 6
Loss = 1.1017e-01, PNorm = 34.1113, GNorm = 5.4620, lr_0 = 6.2751e-04
Validation rmse = 0.102601
Epoch 7
Validation rmse = 0.089448
Epoch 8
Loss = 9.0707e-02, PNorm = 34.1316, GNorm = 0.8933, lr_0 = 5.3234e-04
Validation rmse = 0.072385
Epoch 9
Loss = 6.3609e-02, PNorm = 34.1482, GNorm = 0.8295, lr_0 = 4.6416e-04
Validation rmse = 0.057847
Epoch 10
Validation rmse = 0.066594
Epoch 11
Loss = 3.1332e-02, PNorm = 34.1645, GNorm = 0.6223, lr_0 = 3.9377e-04
Validation rmse = 0.055198
Epoch 12
Loss = 2.5398e-02, PNorm = 34.1747, GNorm = 0.2998, lr_0 = 3.3866e-04
Validation rmse = 0.077204
Epoch 13
Validation rmse = 0.065781
Epoch 14
Loss = 2.9615e-02, PNorm = 34.1818, GNorm = 2.7138, lr_0 = 2.9126e-04
Validation rmse = 0.055710
Epoch 15
Validation rmse = 0.061602
Epoch 16
Loss = 2.6452e-02, PNorm = 34.1878, GNorm = 2.9117, lr_0 = 2.4709e-04
Validation rmse = 0.051576
Epoch 17
Loss = 1.9413e-02, PNorm = 34.1929, GNorm = 1.6741, lr_0 = 2.1544e-04
Validation rmse = 0.061228
Epoch 18
Validation rmse = 0.047281
Epoch 19
Loss = 9.6701e-03, PNorm = 34.1981, GNorm = 1.0043, lr_0 = 1.8277e-04
Validation rmse = 0.049944
Epoch 20
Loss = 1.3522e-02, PNorm = 34.2020, GNorm = 1.3316, lr_0 = 1.5719e-04
Validation rmse = 0.047714
Epoch 21
Validation rmse = 0.047500
Epoch 22
Loss = 1.0122e-02, PNorm = 34.2045, GNorm = 0.6082, lr_0 = 1.3519e-04
Validation rmse = 0.047323
Epoch 23
Validation rmse = 0.047523
Epoch 24
Loss = 8.7573e-03, PNorm = 34.2072, GNorm = 0.8702, lr_0 = 1.1469e-04
Validation rmse = 0.046799
Epoch 25
Loss = 7.2988e-03, PNorm = 34.2093, GNorm = 0.2387, lr_0 = 1.0000e-04
Validation rmse = 0.048381
Epoch 26
Validation rmse = 0.046681
Epoch 27
Loss = 9.3176e-03, PNorm = 34.2114, GNorm = 0.5069, lr_0 = 1.0000e-04
Validation rmse = 0.045033
Epoch 28
Loss = 7.8374e-03, PNorm = 34.2128, GNorm = 0.2641, lr_0 = 1.0000e-04
Loss = 5.2862e-03, PNorm = 34.2130, GNorm = 0.5368, lr_0 = 1.0000e-04
Validation rmse = 0.044596
Epoch 29
Validation rmse = 0.045198
Model 0 best validation rmse = 0.044596 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.038174
Ensemble test rmse = 0.038174
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation rmse = 0.249407
Epoch 1
Loss = 4.2840e-01, PNorm = 34.0296, GNorm = 5.7881, lr_0 = 1.0000e-03
Validation rmse = 0.174374
Epoch 2
Validation rmse = 0.138218
Epoch 3
Loss = 1.7500e-01, PNorm = 34.0614, GNorm = 1.6449, lr_0 = 8.4834e-04
Validation rmse = 0.126112
Epoch 4
Loss = 1.5873e-01, PNorm = 34.0847, GNorm = 2.6800, lr_0 = 7.2962e-04
Validation rmse = 0.134028
Epoch 5
Validation rmse = 0.100602
Epoch 6
Loss = 1.1921e-01, PNorm = 34.1090, GNorm = 0.4894, lr_0 = 6.2751e-04
Validation rmse = 0.090699
Epoch 7
Validation rmse = 0.075803
Epoch 8
Loss = 7.9127e-02, PNorm = 34.1354, GNorm = 3.9871, lr_0 = 5.3234e-04
Validation rmse = 0.067529
Epoch 9
Loss = 3.2620e-02, PNorm = 34.1521, GNorm = 0.1644, lr_0 = 4.6416e-04
Validation rmse = 0.056926
Epoch 10
Validation rmse = 0.078260
Epoch 11
Loss = 3.8622e-02, PNorm = 34.1649, GNorm = 2.0096, lr_0 = 3.9377e-04
Validation rmse = 0.051435
Epoch 12
Loss = 1.8160e-02, PNorm = 34.1722, GNorm = 0.2391, lr_0 = 3.3866e-04
Validation rmse = 0.049265
Epoch 13
Validation rmse = 0.048577
Epoch 14
Loss = 1.8198e-02, PNorm = 34.1777, GNorm = 1.0909, lr_0 = 2.9126e-04
Validation rmse = 0.048564
Epoch 15
Validation rmse = 0.047512
Epoch 16
Loss = 1.1563e-02, PNorm = 34.1813, GNorm = 0.7019, lr_0 = 2.4709e-04
Validation rmse = 0.047314
Epoch 17
Loss = 1.1962e-02, PNorm = 34.1843, GNorm = 0.2890, lr_0 = 2.1544e-04
Validation rmse = 0.046726
Epoch 18
Validation rmse = 0.047045
Epoch 19
Loss = 9.8921e-03, PNorm = 34.1875, GNorm = 0.2565, lr_0 = 1.8277e-04
Validation rmse = 0.048600
Epoch 20
Loss = 1.0863e-02, PNorm = 34.1898, GNorm = 1.9858, lr_0 = 1.5719e-04
Validation rmse = 0.046665
Epoch 21
Validation rmse = 0.045735
Epoch 22
Loss = 8.2802e-03, PNorm = 34.1916, GNorm = 0.8136, lr_0 = 1.3519e-04
Validation rmse = 0.044158
Epoch 23
Validation rmse = 0.043676
Epoch 24
Loss = 8.1349e-03, PNorm = 34.1936, GNorm = 0.5505, lr_0 = 1.1469e-04
Validation rmse = 0.043595
Epoch 25
Loss = 8.4005e-03, PNorm = 34.1949, GNorm = 0.3204, lr_0 = 1.0000e-04
Validation rmse = 0.044002
Epoch 26
Validation rmse = 0.042890
Epoch 27
Loss = 6.9274e-03, PNorm = 34.1962, GNorm = 0.4672, lr_0 = 1.0000e-04
Validation rmse = 0.043370
Epoch 28
Loss = 7.0188e-03, PNorm = 34.1979, GNorm = 0.1219, lr_0 = 1.0000e-04
Loss = 1.0949e-02, PNorm = 34.1981, GNorm = 0.5847, lr_0 = 1.0000e-04
Validation rmse = 0.044408
Epoch 29
Validation rmse = 0.042501
Model 0 best validation rmse = 0.042501 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test rmse = 0.047320
Ensemble test rmse = 0.047320
5-fold cross validation
	Seed 0 ==> test rmse = 0.062697
	Seed 1 ==> test rmse = 0.037610
	Seed 2 ==> test rmse = 0.037951
	Seed 3 ==> test rmse = 0.038174
	Seed 4 ==> test rmse = 0.047320
Overall test rmse = 0.044750 +/- 0.009687
Elapsed time = 0:02:17
Command line
python ./chemprop/train.py --data_path ./csv_files/trimers_Eat.csv --dataset_type regression --save_dir checkpoint --num_folds 5 --metric r2
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './csv_files/trimers_Eat.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'r2',
 'metrics': ['r2'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Eat'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573635
Epoch 1
Loss = 4.0732e-01, PNorm = 34.0308, GNorm = 3.8868, lr_0 = 1.0000e-03
Validation r2 = 0.766555
Epoch 2
Validation r2 = 0.838974
Epoch 3
Loss = 2.0783e-01, PNorm = 34.0632, GNorm = 6.0915, lr_0 = 8.4834e-04
Validation r2 = 0.871292
Epoch 4
Loss = 1.6689e-01, PNorm = 34.0856, GNorm = 1.0182, lr_0 = 7.2962e-04
Validation r2 = 0.826266
Epoch 5
Validation r2 = 0.898616
Epoch 6
Loss = 8.6768e-02, PNorm = 34.1060, GNorm = 2.5587, lr_0 = 6.2751e-04
Validation r2 = 0.912944
Epoch 7
Validation r2 = 0.920694
Epoch 8
Loss = 2.7497e-02, PNorm = 34.1289, GNorm = 1.8941, lr_0 = 5.3234e-04
Validation r2 = 0.938624
Epoch 9
Loss = 4.3814e-02, PNorm = 34.1470, GNorm = 0.8257, lr_0 = 4.6416e-04
Validation r2 = 0.944418
Epoch 10
Validation r2 = 0.947835
Epoch 11
Loss = 3.7444e-02, PNorm = 34.1614, GNorm = 3.5345, lr_0 = 3.9377e-04
Validation r2 = 0.952106
Epoch 12
Loss = 2.6658e-02, PNorm = 34.1707, GNorm = 2.4614, lr_0 = 3.3866e-04
Validation r2 = 0.963150
Epoch 13
Validation r2 = 0.962775
Epoch 14
Loss = 1.7791e-02, PNorm = 34.1783, GNorm = 0.9271, lr_0 = 2.9126e-04
Validation r2 = 0.965388
Epoch 15
Validation r2 = 0.969757
Epoch 16
Loss = 1.2962e-02, PNorm = 34.1841, GNorm = 0.2951, lr_0 = 2.4709e-04
Validation r2 = 0.971451
Epoch 17
Loss = 7.3941e-03, PNorm = 34.1879, GNorm = 0.2675, lr_0 = 2.1544e-04
Validation r2 = 0.972829
Epoch 18
Validation r2 = 0.973228
Epoch 19
Loss = 1.9084e-02, PNorm = 34.1911, GNorm = 2.6326, lr_0 = 1.8277e-04
Validation r2 = 0.974482
Epoch 20
Loss = 1.4619e-02, PNorm = 34.1933, GNorm = 2.6697, lr_0 = 1.5719e-04
Validation r2 = 0.973462
Epoch 21
Validation r2 = 0.974309
Epoch 22
Loss = 1.4602e-02, PNorm = 34.1953, GNorm = 0.7436, lr_0 = 1.3519e-04
Validation r2 = 0.977283
Epoch 23
Validation r2 = 0.977629
Epoch 24
Loss = 9.3576e-03, PNorm = 34.1974, GNorm = 0.2251, lr_0 = 1.1469e-04
Validation r2 = 0.977687
Epoch 25
Loss = 1.1266e-02, PNorm = 34.1988, GNorm = 1.8616, lr_0 = 1.0000e-04
Validation r2 = 0.978325
Epoch 26
Validation r2 = 0.978153
Epoch 27
Loss = 9.3101e-03, PNorm = 34.2006, GNorm = 0.2072, lr_0 = 1.0000e-04
Validation r2 = 0.979978
Epoch 28
Loss = 8.3333e-03, PNorm = 34.2021, GNorm = 0.2513, lr_0 = 1.0000e-04
Loss = 4.1585e-03, PNorm = 34.2022, GNorm = 0.5450, lr_0 = 1.0000e-04
Validation r2 = 0.980452
Epoch 29
Validation r2 = 0.980756
Model 0 best validation r2 = 0.980756 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.968928
Ensemble test r2 = 0.968928
Fold 1
Splitting data with seed 1
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.599386
Epoch 1
Loss = 4.5551e-01, PNorm = 34.0314, GNorm = 16.1830, lr_0 = 1.0000e-03
Validation r2 = 0.790042
Epoch 2
Validation r2 = 0.842139
Epoch 3
Loss = 1.7934e-01, PNorm = 34.0673, GNorm = 4.8361, lr_0 = 8.4834e-04
Validation r2 = 0.871593
Epoch 4
Loss = 1.8540e-01, PNorm = 34.0901, GNorm = 0.8777, lr_0 = 7.2962e-04
Validation r2 = 0.759882
Epoch 5
Validation r2 = 0.888048
Epoch 6
Loss = 1.1832e-01, PNorm = 34.1134, GNorm = 3.1469, lr_0 = 6.2751e-04
Validation r2 = 0.848108
Epoch 7
Validation r2 = 0.894699
Epoch 8
Loss = 8.3449e-02, PNorm = 34.1358, GNorm = 1.7009, lr_0 = 5.3234e-04
Validation r2 = 0.928936
Epoch 9
Loss = 4.9928e-02, PNorm = 34.1537, GNorm = 2.4468, lr_0 = 4.6416e-04
Validation r2 = 0.918774
Epoch 10
Validation r2 = 0.922338
Epoch 11
Loss = 4.4093e-02, PNorm = 34.1688, GNorm = 2.7365, lr_0 = 3.9377e-04
Validation r2 = 0.948223
Epoch 12
Loss = 2.2729e-02, PNorm = 34.1788, GNorm = 0.8159, lr_0 = 3.3866e-04
Validation r2 = 0.955790
Epoch 13
Validation r2 = 0.954074
Epoch 14
Loss = 1.6776e-02, PNorm = 34.1865, GNorm = 0.3069, lr_0 = 2.9126e-04
Validation r2 = 0.957789
Epoch 15
Validation r2 = 0.961307
Epoch 16
Loss = 1.9600e-02, PNorm = 34.1931, GNorm = 0.4563, lr_0 = 2.4709e-04
Validation r2 = 0.970709
Epoch 17
Loss = 1.3360e-02, PNorm = 34.1982, GNorm = 0.6259, lr_0 = 2.1544e-04
Validation r2 = 0.965460
Epoch 18
Validation r2 = 0.971202
Epoch 19
Loss = 8.1413e-03, PNorm = 34.2025, GNorm = 0.4685, lr_0 = 1.8277e-04
Validation r2 = 0.967340
Epoch 20
Loss = 1.0332e-02, PNorm = 34.2050, GNorm = 0.5349, lr_0 = 1.5719e-04
Validation r2 = 0.969008
Epoch 21
Validation r2 = 0.968372
Epoch 22
Loss = 9.1525e-03, PNorm = 34.2081, GNorm = 0.8355, lr_0 = 1.3519e-04
Validation r2 = 0.976375
Epoch 23
Validation r2 = 0.965844
Epoch 24
Loss = 1.0042e-02, PNorm = 34.2103, GNorm = 0.7228, lr_0 = 1.1469e-04
Validation r2 = 0.975098
Epoch 25
Loss = 6.1947e-03, PNorm = 34.2124, GNorm = 1.0822, lr_0 = 1.0000e-04
Validation r2 = 0.976465
Epoch 26
Validation r2 = 0.975602
Epoch 27
Loss = 9.0888e-03, PNorm = 34.2144, GNorm = 0.6327, lr_0 = 1.0000e-04
Validation r2 = 0.977531
Epoch 28
Loss = 7.1370e-03, PNorm = 34.2165, GNorm = 0.4184, lr_0 = 1.0000e-04
Loss = 5.4477e-03, PNorm = 34.2167, GNorm = 1.5345, lr_0 = 1.0000e-04
Validation r2 = 0.978620
Epoch 29
Validation r2 = 0.976268
Model 0 best validation r2 = 0.978620 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991819
Ensemble test r2 = 0.991819
Fold 2
Splitting data with seed 2
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.691167
Epoch 1
Loss = 2.9264e-01, PNorm = 34.0308, GNorm = 3.2897, lr_0 = 1.0000e-03
Validation r2 = 0.733268
Epoch 2
Validation r2 = 0.760222
Epoch 3
Loss = 1.4465e-01, PNorm = 34.0675, GNorm = 3.5673, lr_0 = 8.4834e-04
Validation r2 = 0.831569
Epoch 4
Loss = 1.1255e-01, PNorm = 34.0934, GNorm = 5.1881, lr_0 = 7.2962e-04
Validation r2 = 0.748199
Epoch 5
Validation r2 = 0.851853
Epoch 6
Loss = 1.0746e-01, PNorm = 34.1106, GNorm = 5.9695, lr_0 = 6.2751e-04
Validation r2 = 0.870190
Epoch 7
Validation r2 = 0.922673
Epoch 8
Loss = 4.6097e-02, PNorm = 34.1237, GNorm = 0.6533, lr_0 = 5.3234e-04
Validation r2 = 0.930392
Epoch 9
Loss = 3.3392e-02, PNorm = 34.1366, GNorm = 1.9340, lr_0 = 4.6416e-04
Validation r2 = 0.944514
Epoch 10
Validation r2 = 0.950440
Epoch 11
Loss = 1.9874e-02, PNorm = 34.1493, GNorm = 0.7251, lr_0 = 3.9377e-04
Validation r2 = 0.955992
Epoch 12
Loss = 1.8196e-02, PNorm = 34.1565, GNorm = 0.6162, lr_0 = 3.3866e-04
Validation r2 = 0.960628
Epoch 13
Validation r2 = 0.962965
Epoch 14
Loss = 1.5607e-02, PNorm = 34.1610, GNorm = 0.7442, lr_0 = 2.9126e-04
Validation r2 = 0.963312
Epoch 15
Validation r2 = 0.971306
Epoch 16
Loss = 9.4105e-03, PNorm = 34.1649, GNorm = 0.1494, lr_0 = 2.4709e-04
Validation r2 = 0.972483
Epoch 17
Loss = 1.2791e-02, PNorm = 34.1674, GNorm = 0.5708, lr_0 = 2.1544e-04
Validation r2 = 0.974099
Epoch 18
Validation r2 = 0.972929
Epoch 19
Loss = 1.4036e-02, PNorm = 34.1705, GNorm = 0.8238, lr_0 = 1.8277e-04
Validation r2 = 0.976565
Epoch 20
Loss = 1.1074e-02, PNorm = 34.1729, GNorm = 0.3476, lr_0 = 1.5719e-04
Validation r2 = 0.975636
Epoch 21
Validation r2 = 0.976595
Epoch 22
Loss = 1.2668e-02, PNorm = 34.1744, GNorm = 2.1022, lr_0 = 1.3519e-04
Validation r2 = 0.977729
Epoch 23
Validation r2 = 0.977451
Epoch 24
Loss = 8.6141e-03, PNorm = 34.1763, GNorm = 0.9590, lr_0 = 1.1469e-04
Validation r2 = 0.979555
Epoch 25
Loss = 1.0335e-02, PNorm = 34.1781, GNorm = 1.0870, lr_0 = 1.0000e-04
Validation r2 = 0.982166
Epoch 26
Validation r2 = 0.982579
Epoch 27
Loss = 1.0322e-02, PNorm = 34.1797, GNorm = 0.3450, lr_0 = 1.0000e-04
Validation r2 = 0.982161
Epoch 28
Loss = 8.0901e-03, PNorm = 34.1810, GNorm = 0.2512, lr_0 = 1.0000e-04
Loss = 2.1964e-02, PNorm = 34.1812, GNorm = 1.4292, lr_0 = 1.0000e-04
Validation r2 = 0.980336
Epoch 29
Validation r2 = 0.982151
Model 0 best validation r2 = 0.982579 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.988009
Ensemble test r2 = 0.988009
Fold 3
Splitting data with seed 3
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.573855
Epoch 1
Loss = 3.3437e-01, PNorm = 34.0301, GNorm = 8.7927, lr_0 = 1.0000e-03
Validation r2 = 0.646637
Epoch 2
Validation r2 = 0.711635
Epoch 3
Loss = 2.4031e-01, PNorm = 34.0631, GNorm = 10.2145, lr_0 = 8.4834e-04
Validation r2 = 0.781623
Epoch 4
Loss = 1.6651e-01, PNorm = 34.0848, GNorm = 5.7196, lr_0 = 7.2962e-04
Validation r2 = 0.815695
Epoch 5
Validation r2 = 0.833713
Epoch 6
Loss = 1.0759e-01, PNorm = 34.1047, GNorm = 4.2482, lr_0 = 6.2751e-04
Validation r2 = 0.872905
Epoch 7
Validation r2 = 0.920961
Epoch 8
Loss = 8.9567e-02, PNorm = 34.1259, GNorm = 1.5528, lr_0 = 5.3234e-04
Validation r2 = 0.964139
Epoch 9
Loss = 4.3858e-02, PNorm = 34.1439, GNorm = 1.4386, lr_0 = 4.6416e-04
Validation r2 = 0.980910
Epoch 10
Validation r2 = 0.975929
Epoch 11
Loss = 2.0314e-02, PNorm = 34.1582, GNorm = 0.6164, lr_0 = 3.9377e-04
Validation r2 = 0.981965
Epoch 12
Loss = 1.8508e-02, PNorm = 34.1678, GNorm = 0.4706, lr_0 = 3.3866e-04
Validation r2 = 0.965875
Epoch 13
Validation r2 = 0.966932
Epoch 14
Loss = 2.0515e-02, PNorm = 34.1743, GNorm = 0.6786, lr_0 = 2.9126e-04
Validation r2 = 0.973358
Epoch 15
Validation r2 = 0.983405
Epoch 16
Loss = 1.0714e-02, PNorm = 34.1798, GNorm = 0.5761, lr_0 = 2.4709e-04
Validation r2 = 0.976861
Epoch 17
Loss = 1.1012e-02, PNorm = 34.1836, GNorm = 0.9217, lr_0 = 2.1544e-04
Validation r2 = 0.982884
Epoch 18
Validation r2 = 0.983018
Epoch 19
Loss = 7.3484e-03, PNorm = 34.1875, GNorm = 0.6154, lr_0 = 1.8277e-04
Validation r2 = 0.983012
Epoch 20
Loss = 9.4453e-03, PNorm = 34.1904, GNorm = 0.6892, lr_0 = 1.5719e-04
Validation r2 = 0.982890
Epoch 21
Validation r2 = 0.981571
Epoch 22
Loss = 8.6295e-03, PNorm = 34.1924, GNorm = 0.2901, lr_0 = 1.3519e-04
Validation r2 = 0.983493
Epoch 23
Validation r2 = 0.982281
Epoch 24
Loss = 1.1932e-02, PNorm = 34.1944, GNorm = 1.8421, lr_0 = 1.1469e-04
Validation r2 = 0.983451
Epoch 25
Loss = 6.8996e-03, PNorm = 34.1961, GNorm = 0.9841, lr_0 = 1.0000e-04
Validation r2 = 0.985098
Epoch 26
Validation r2 = 0.984680
Epoch 27
Loss = 8.6244e-03, PNorm = 34.1977, GNorm = 1.7895, lr_0 = 1.0000e-04
Validation r2 = 0.985494
Epoch 28
Loss = 6.8766e-03, PNorm = 34.1989, GNorm = 0.3844, lr_0 = 1.0000e-04
Loss = 3.5045e-03, PNorm = 34.1990, GNorm = 0.3805, lr_0 = 1.0000e-04
Validation r2 = 0.985574
Epoch 29
Validation r2 = 0.985642
Model 0 best validation r2 = 0.985642 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.991334
Ensemble test r2 = 0.991334
Fold 4
Splitting data with seed 4
Total size = 390 | train size = 312 | val size = 39 | test size = 39
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Validation r2 = 0.579424
Epoch 1
Loss = 3.5941e-01, PNorm = 34.0296, GNorm = 2.7011, lr_0 = 1.0000e-03
Validation r2 = 0.751844
Epoch 2
Validation r2 = 0.826631
Epoch 3
Loss = 2.1796e-01, PNorm = 34.0626, GNorm = 3.5091, lr_0 = 8.4834e-04
Validation r2 = 0.867047
Epoch 4
Loss = 1.5362e-01, PNorm = 34.0868, GNorm = 3.8505, lr_0 = 7.2962e-04
Validation r2 = 0.916895
Epoch 5
Validation r2 = 0.938662
Epoch 6
Loss = 1.1292e-01, PNorm = 34.1102, GNorm = 1.2028, lr_0 = 6.2751e-04
Validation r2 = 0.959495
Epoch 7
Validation r2 = 0.972531
Epoch 8
Loss = 5.8828e-02, PNorm = 34.1351, GNorm = 0.5699, lr_0 = 5.3234e-04
Validation r2 = 0.965137
Epoch 9
Loss = 3.3841e-02, PNorm = 34.1522, GNorm = 1.4634, lr_0 = 4.6416e-04
Validation r2 = 0.977506
Epoch 10
Validation r2 = 0.965826
Epoch 11
Loss = 3.1129e-02, PNorm = 34.1645, GNorm = 4.0756, lr_0 = 3.9377e-04
Validation r2 = 0.980807
Epoch 12
Loss = 1.5232e-02, PNorm = 34.1713, GNorm = 0.2574, lr_0 = 3.3866e-04
Validation r2 = 0.981321
Epoch 13
Validation r2 = 0.988050
Epoch 14
Loss = 1.6028e-02, PNorm = 34.1765, GNorm = 2.2812, lr_0 = 2.9126e-04
Validation r2 = 0.987031
Epoch 15
Validation r2 = 0.985849
Epoch 16
Loss = 8.5342e-03, PNorm = 34.1800, GNorm = 0.7103, lr_0 = 2.4709e-04
Validation r2 = 0.985763
Epoch 17
Loss = 1.0411e-02, PNorm = 34.1828, GNorm = 0.8029, lr_0 = 2.1544e-04
Validation r2 = 0.987620
Epoch 18
Validation r2 = 0.988438
Epoch 19
Loss = 8.4644e-03, PNorm = 34.1858, GNorm = 0.2579, lr_0 = 1.8277e-04
Validation r2 = 0.987417
Epoch 20
Loss = 7.9774e-03, PNorm = 34.1878, GNorm = 1.2829, lr_0 = 1.5719e-04
Validation r2 = 0.988023
Epoch 21
Validation r2 = 0.989097
Epoch 22
Loss = 6.3970e-03, PNorm = 34.1897, GNorm = 0.8511, lr_0 = 1.3519e-04
Validation r2 = 0.989879
Epoch 23
Validation r2 = 0.989853
Epoch 24
Loss = 5.2683e-03, PNorm = 34.1917, GNorm = 0.2997, lr_0 = 1.1469e-04
Validation r2 = 0.990055
Epoch 25
Loss = 6.3018e-03, PNorm = 34.1931, GNorm = 0.1126, lr_0 = 1.0000e-04
Validation r2 = 0.988737
Epoch 26
Validation r2 = 0.990402
Epoch 27
Loss = 5.1890e-03, PNorm = 34.1946, GNorm = 0.9949, lr_0 = 1.0000e-04
Validation r2 = 0.989937
Epoch 28
Loss = 5.3544e-03, PNorm = 34.1962, GNorm = 0.0834, lr_0 = 1.0000e-04
Loss = 7.7945e-03, PNorm = 34.1964, GNorm = 0.7449, lr_0 = 1.0000e-04
Validation r2 = 0.989768
Epoch 29
Validation r2 = 0.990435
Model 0 best validation r2 = 0.990435 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test r2 = 0.986382
Ensemble test r2 = 0.986382
5-fold cross validation
	Seed 0 ==> test r2 = 0.968928
	Seed 1 ==> test r2 = 0.991819
	Seed 2 ==> test r2 = 0.988009
	Seed 3 ==> test r2 = 0.991334
	Seed 4 ==> test r2 = 0.986382
Overall test r2 = 0.985295 +/- 0.008431
Elapsed time = 0:07:28
